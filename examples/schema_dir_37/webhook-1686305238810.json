{"status":"Failed","policy":{"name":"Webhooks","description":""},"findingKey":"sC4A0DzUA8w2sOqDuZZd0Q","findingId":"sC4A0DzUA8w2sOqDuZZd0Q","cloudGuardAccountId":"51722","origin":"Compliance Engine","bundle":{"name":"GCP CloudGuard Best Practices","description":"CloudGuard Best Practices for securing GCP Account","id":-9},"reportTime":"2023-06-09T09:04:54.86Z","rule":{"name":"Ensure that Service Account has no Admin privileges","ruleId":"D9.GCP.IAM.05","description":"A Service Account is a special Google account that belongs to your application or a VM, instead of to an individual end user. Your application uses the service account to call the Google API of a service, so that the users aren't directly involved It's recommended not to use admin access for Service Account.","remediation":"\n**From Portal**\n1. Go to IAM & admin/IAM using https://console.cloud.google.com/iam-admin/iam\n2. Go to the Principals\n3. Identify the service account with over-permissive roles, click on the edit member icon.\n4. Identify the over-permissive roles and click on the delete bin icon to remove role from the service account.\n\n\n**From Command Line**\n\n1. Get the policy that you want to modify, and write it to a file:\n```\ngcloud projects get-iam-policy PROJECT_ID > PATH_TO_NEWLY_CREATED_FILE\n```\n2. In the created file, detect the overly permissive service account and delete any role containing 'admin', 'roles/owner' or 'roles/editor'\n3. Set the new iam policy of the service account:\n```\ngcloud projects set-iam-policy PROJECT_ID PATH_TO_EDITED_FILE\n```\n\n**References**\n1. https://cloud.google.com/sdk/gcloud/reference/projects/get-iam-policy\n2. https://cloud.google.com/sdk/gcloud/reference/projects/set-iam-policy\n3. https://cloud.google.com/iam/docs/understanding-roles\n4. https://cloud.google.com/iam/docs/understanding-service-accounts\n","complianceTags":"Identity and Access Management","logicHash":"lJY3qAzm2o6SnzsnEOMFJA","severity":"High"},"account":{"id":"serious-conduit-389105","name":"GCP Demo Account NU","vendor":"GCP","dome9CloudAccountId":"ca5ef528-d8dd-41d8-a022-1a820a6adb60","organizationalUnitId":"00000000-0000-0000-0000-000000000000","organizationalUnitPath":""},"region":"Global","entity":{"displayName":"Compute Engine default service account","email":"554880214893-compute@developer.gserviceaccount.com","oauth2ClientId":"109752848574392986178","projectId":"serious-conduit-389105","uniqueId":"109752848574392986178","keys":[{"keyAlgorithm":"KEY_ALG_RSA_2048","name":"projects/serious-conduit-389105/serviceAccounts/554880214893-compute@developer.gserviceaccount.com/keys/88e7cf6f36b028fbd0057bcce4f7f5f9e905d884","privateKeyData":null,"privateKeyType":null,"publicKeyData":null,"validAfterTime":1686115247,"validBeforeTime":1751169630,"eTag":null,"managedBy":"System"}],"roles":["roles/editor"],"auditConfigsExemption":null,"selfLink":null,"id":"109752848574392986178","type":"ServiceAccount","name":"projects/serious-conduit-389105/serviceAccounts/554880214893-compute@developer.gserviceaccount.com","dome9Id":"8|ca5ef528-d8dd-41d8-a022-1a820a6adb60|ServiceAccount|projects/serious-conduit-389105/serviceAccounts/554880214893-compute@developer.gserviceaccount.com","accountNumber":"serious-conduit-389105","assetLabels":null,"region":"Global","externalFindings":null},"remediationActions":[],"action":"Detect","additionalFields":[]}