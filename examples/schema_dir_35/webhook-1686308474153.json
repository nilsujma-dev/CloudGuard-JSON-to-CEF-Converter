{"status":"Failed","policy":{"name":"Webhooks","description":""},"findingKey":"AkZjGOrOWyQAuPu92/E1Eg","findingId":"AkZjGOrOWyQAuPu92/E1Eg","cloudGuardAccountId":"51722","origin":"Compliance Engine","bundle":{"name":"CIS Kubernetes Benchmark v1.6.1","description":"Automated Validation of Kubernetes CIS Benchmark v1.6.1 Prescriptive guidance for establishing a secure configuration posture for Kubernetes 1.6.1\nFor additional reference: https://www.cisecurity.org/benchmark/kubernetes/","id":-70},"reportTime":"2023-06-09T11:00:31.243Z","rule":{"name":"Apply Security Context to Your Pods and Containers","ruleId":"D9.K8S.OPE.06","description":"Apply Security Context to Your Pods and Containers. A security context defines the operating system security settings (uid, gid, capabilities, SELinux role, etc..) applied to a container. When designing your containers and pods, make sure that you configure the security context for your pods, containers, and volumes. A security context is a property defined in the deployment yaml. It controls the security parameters that will be assigned to the pod/container/volume.","remediation":"Follow the Kubernetes documentation and apply security contexts to your pods. For a suggested list of security contexts, you may refer to the CIS Security Benchmark for Docker Containers.\n**References**\nhttps://kubernetes.io/docs/concepts/policy/security-context/","complianceTags":"5.6.3","logicHash":"IESpWUCb45AmMIPF+zZBxA","severity":"Low"},"account":{"id":"5af13ab5-72ed-43b6-9544-33c9236d62f0","name":"nu-openshift-cluster","vendor":"Kubernetes","dome9CloudAccountId":"5af13ab5-72ed-43b6-9544-33c9236d62f0","organizationalUnitId":"00000000-0000-0000-0000-000000000000","organizationalUnitPath":""},"region":"Global","entity":{"spec":{"affinity":null,"containers":[{"args":["--config=/etc/kubernetes/static-pod-resources/configmaps/config/config.yaml","--cert-dir=/var/run/kubernetes","--authentication-kubeconfig=/etc/kubernetes/static-pod-resources/configmaps/scheduler-kubeconfig/kubeconfig","--authorization-kubeconfig=/etc/kubernetes/static-pod-resources/configmaps/scheduler-kubeconfig/kubeconfig","--feature-gates=APIPriorityAndFairness=true,CSIMigrationAWS=false,CSIMigrationAzureFile=false,CSIMigrationGCE=false,CSIMigrationvSphere=false,DownwardAPIHugePages=true,PodSecurity=true,RotateKubeletServerCertificate=true","-v=2","--tls-cert-file=/etc/kubernetes/static-pod-resources/secrets/serving-cert/tls.crt","--tls-private-key-file=/etc/kubernetes/static-pod-resources/secrets/serving-cert/tls.key","--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256","--tls-min-version=VersionTLS12"],"command":["hyperkube","kube-scheduler"],"env":null,"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:7dd9070ddd5c6d877e6431af587973c39f97f753f2c504b43c4841d5ac3f3733","livenessProbe":{"exec":null,"failureThreshold":3,"httpGet":{"host":null,"path":"healthz","port":"10259","scheme":"HTTPS","httpHeaders":null},"initialDelaySeconds":45,"periodSeconds":10,"successThreshold":1,"tcpSocket":null,"timeoutSeconds":1},"name":"kube-scheduler","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:7dd9070ddd5c6d877e6431af587973c39f97f753f2c504b43c4841d5ac3f3733"},"parsedArgs":[{"key":"config","value":"/etc/kubernetes/static-pod-resources/configmaps/config/config.yaml"},{"key":"cert-dir","value":"/var/run/kubernetes"},{"key":"authentication-kubeconfig","value":"/etc/kubernetes/static-pod-resources/configmaps/scheduler-kubeconfig/kubeconfig"},{"key":"authorization-kubeconfig","value":"/etc/kubernetes/static-pod-resources/configmaps/scheduler-kubeconfig/kubeconfig"},{"key":"feature-gates","value":"APIPriorityAndFairness=true,CSIMigrationAWS=false,CSIMigrationAzureFile=false,CSIMigrationGCE=false,CSIMigrationvSphere=false,DownwardAPIHugePages=true,PodSecurity=true,RotateKubeletServerCertificate=true"},{"key":"v","value":"2"},{"key":"tls-cert-file","value":"/etc/kubernetes/static-pod-resources/secrets/serving-cert/tls.crt"},{"key":"tls-private-key-file","value":"/etc/kubernetes/static-pod-resources/secrets/serving-cert/tls.key"},{"key":"tls-cipher-suites","value":"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"},{"key":"tls-min-version","value":"VersionTLS12"}],"ports":[{"containerPort":10259,"hostIP":null,"hostPort":10259,"name":null,"protocol":"TCP"}],"readinessProbe":{"exec":null,"failureThreshold":3,"httpGet":{"host":null,"path":"healthz","port":"10259","scheme":"HTTPS","httpHeaders":null},"initialDelaySeconds":45,"periodSeconds":10,"successThreshold":1,"tcpSocket":null,"timeoutSeconds":1},"resources":{"limits":null,"requests":{"memory":"50Mi","cpu":"15m"}},"securityContext":null,"volumeMounts":[{"name":"resource-dir","mountPath":"/etc/kubernetes/static-pod-resources","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"cert-dir","mountPath":"/etc/kubernetes/static-pod-certs","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null}]},{"args":["--kubeconfig=/etc/kubernetes/static-pod-resources/configmaps/kube-scheduler-cert-syncer-kubeconfig/kubeconfig","--namespace=$(POD_NAMESPACE)","--destination-dir=/etc/kubernetes/static-pod-certs"],"command":["cluster-kube-scheduler-operator","cert-syncer"],"env":[{"name":"POD_NAME","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"POD_NAMESPACE","value":null,"valueFrom":{"secretKeyRef":null}}],"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:a8d34b9d10feb78adf89f9e3ec73e1080d763807c1394683cbec59f1292efad1","livenessProbe":null,"name":"kube-scheduler-cert-syncer","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:a8d34b9d10feb78adf89f9e3ec73e1080d763807c1394683cbec59f1292efad1"},"parsedArgs":[{"key":"kube-scheduler-operator","value":"cert-syncer"},{"key":"kubeconfig","value":"/etc/kubernetes/static-pod-resources/configmaps/kube-scheduler-cert-syncer-kubeconfig/kubeconfig"},{"key":"namespace","value":"$(POD_NAMESPACE)"},{"key":"destination-dir","value":"/etc/kubernetes/static-pod-certs"}],"ports":null,"readinessProbe":null,"resources":{"limits":null,"requests":{"memory":"50Mi","cpu":"5m"}},"securityContext":null,"volumeMounts":[{"name":"resource-dir","mountPath":"/etc/kubernetes/static-pod-resources","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"cert-dir","mountPath":"/etc/kubernetes/static-pod-certs","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null}]},{"args":["timeout 3m /bin/bash -exuo pipefail -c 'while [ -n \"$(ss -Htanop \\( sport = 11443 \\))\" ]; do sleep 1; done'\n\nexec cluster-kube-scheduler-operator cert-recovery-controller --kubeconfig=/etc/kubernetes/static-pod-resources/configmaps/kube-scheduler-cert-syncer-kubeconfig/kubeconfig  --namespace=${POD_NAMESPACE} --listen=0.0.0.0:11443 -v=2\n"],"command":["/bin/bash","-euxo","pipefail","-c"],"env":[{"name":"POD_NAMESPACE","value":null,"valueFrom":{"secretKeyRef":null}}],"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:a8d34b9d10feb78adf89f9e3ec73e1080d763807c1394683cbec59f1292efad1","livenessProbe":null,"name":"kube-scheduler-recovery-controller","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:a8d34b9d10feb78adf89f9e3ec73e1080d763807c1394683cbec59f1292efad1"},"parsedArgs":[{"key":"euxo","value":"pipefail"},{"key":"c","value":"timeout 3m /bin/bash"},{"key":"exuo","value":"pipefail"},{"key":"c","value":"'while ["},{"key":"n","value":"\"$(ss"},{"key":"Htanop","value":"\\( sport = 11443 \\))\" ]; do sleep 1; done'exec cluster-kube-scheduler-operator cert-recovery-controller"},{"key":"kubeconfig","value":"/etc/kubernetes/static-pod-resources/configmaps/kube-scheduler-cert-syncer-kubeconfig/kubeconfig "},{"key":"namespace","value":"${POD_NAMESPACE}"},{"key":"listen","value":"0.0.0.0:11443"},{"key":"v","value":"2"}],"ports":null,"readinessProbe":null,"resources":{"limits":null,"requests":{"memory":"50Mi","cpu":"5m"}},"securityContext":null,"volumeMounts":[{"name":"resource-dir","mountPath":"/etc/kubernetes/static-pod-resources","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"cert-dir","mountPath":"/etc/kubernetes/static-pod-certs","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null}]}],"dnsConfig":null,"hostAliases":null,"hostIPC":false,"hostNetwork":true,"hostPID":false,"initContainers":[{"args":["echo -n \"Waiting for port :10259 to be released.\"\nwhile [ -n \"$(ss -Htan '( sport = 10259 )')\" ]; do\n  echo -n \".\"\n  sleep 1\ndone\n"],"command":["/usr/bin/timeout","30","/bin/bash","-c"],"env":null,"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:7dd9070ddd5c6d877e6431af587973c39f97f753f2c504b43c4841d5ac3f3733","livenessProbe":null,"name":"wait-for-host-port","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:7dd9070ddd5c6d877e6431af587973c39f97f753f2c504b43c4841d5ac3f3733"},"parsedArgs":[{"key":"c","value":"echo"},{"key":"n","value":"\"Waiting for port :10259 to be released.\"while ["},{"key":"n","value":"\"$(ss"},{"key":"Htan","value":"'( sport = 10259 )')\" ]; do  echo"},{"key":"n","value":"\".\"  sleep 1done"}],"ports":null,"readinessProbe":null,"resources":{"limits":null,"requests":{"memory":"50Mi","cpu":"15m"}},"securityContext":null,"volumeMounts":null}],"nodeInfo":{"conditions":[{"message":"kubelet has sufficient memory available","reason":"KubeletHasSufficientMemory","status":"False","type":"MemoryPressure"},{"message":"kubelet has no disk pressure","reason":"KubeletHasNoDiskPressure","status":"False","type":"DiskPressure"},{"message":"kubelet has sufficient PID available","reason":"KubeletHasSufficientPID","status":"False","type":"PIDPressure"},{"message":"kubelet is posting ready status","reason":"KubeletReady","status":"True","type":"Ready"}],"labels":[{"key":"beta.kubernetes.io/arch","value":"amd64"},{"key":"beta.kubernetes.io/os","value":"linux"},{"key":"kubernetes.io/arch","value":"amd64"},{"key":"kubernetes.io/hostname","value":"control-1.demoenv.local"},{"key":"kubernetes.io/os","value":"linux"},{"key":"node-role.kubernetes.io/master","value":""},{"key":"node.openshift.io/os_id","value":"rhcos"}]},"nodeName":"control-1.demoenv.local","priority":2000001000,"priorityClassName":"system-node-critical","securityContext":{"fsGroup":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"supplementalGroups":null,"sysctls":null,"windowsOptions":null,"seccompProfile":null},"serviceAccount":null,"serviceAccountName":null,"tolerations":[{"key":null,"operator":"Exists","effect":null}],"volumes":[{"hostPath":{"path":"/etc/kubernetes/static-pod-resources/kube-scheduler-pod-10","type":""},"flexVolume":null,"name":"resource-dir","persistentVolumeClaim":null},{"hostPath":{"path":"/etc/kubernetes/static-pod-resources/kube-scheduler-certs","type":""},"flexVolume":null,"name":"cert-dir","persistentVolumeClaim":null}]},"status":{"phase":"Running","podIP":"192.168.10.11"},"networkPolicies":{"ingress":[],"egress":[]},"owner":{"ownerReferences":[{"kind":"Node","uid":"abddf8bc-d0d0-42d8-9b1f-8dbe92ca0cbe","name":"control-1.demoenv.local"}],"rootOwner":{"kind":"Node","uid":"abddf8bc-d0d0-42d8-9b1f-8dbe92ca0cbe","name":"control-1.demoenv.local"}},"tags":[{"key":"app","value":"openshift-kube-scheduler"},{"key":"revision","value":"10"},{"key":"scheduler","value":"true"}],"namespace":"openshift-kube-scheduler","annotations":[{"key":"kubectl.kubernetes.io/default-container","value":"kube-scheduler"},{"key":"kubernetes.io/config.hash","value":"7ab4e6ef62a05964bbdde5c59b0828b0"},{"key":"kubernetes.io/config.mirror","value":"7ab4e6ef62a05964bbdde5c59b0828b0"},{"key":"kubernetes.io/config.seen","value":"2022-12-21T04:13:07.455254475Z"},{"key":"kubernetes.io/config.source","value":"file"},{"key":"target.workload.openshift.io/management","value":"{\"effect\": \"PreferredDuringScheduling\"}"}],"labels":[{"key":"app","value":"openshift-kube-scheduler"},{"key":"revision","value":"10"},{"key":"scheduler","value":"true"}],"creationTime":1671596000,"id":"203d68f8-7552-457a-9000-55674dc17c3c","type":"KubernetesPod","name":"openshift-kube-scheduler-control-1.demoenv.local","dome9Id":"11|5af13ab5-72ed-43b6-9544-33c9236d62f0|Pod|203d68f8-7552-457a-9000-55674dc17c3c","accountNumber":"5af13ab5-72ed-43b6-9544-33c9236d62f0","assetLabels":null,"region":"Global","externalFindings":null},"remediationActions":[],"action":"Detect","additionalFields":[]}