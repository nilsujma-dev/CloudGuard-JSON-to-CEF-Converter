{"status":"Failed","policy":{"name":"Webhooks","description":""},"findingKey":"rtuiZs8+aVRK7Qzr0gQIXw","findingId":"rtuiZs8+aVRK7Qzr0gQIXw","cloudGuardAccountId":"51722","origin":"Compliance Engine","bundle":{"name":"CIS Kubernetes Benchmark v1.6.1","description":"Automated Validation of Kubernetes CIS Benchmark v1.6.1 Prescriptive guidance for establishing a secure configuration posture for Kubernetes 1.6.1\nFor additional reference: https://www.cisecurity.org/benchmark/kubernetes/","id":-70},"reportTime":"2023-06-09T11:00:31.243Z","rule":{"name":"Apply Security Context to Your Pods and Containers","ruleId":"D9.K8S.OPE.06","description":"Apply Security Context to Your Pods and Containers. A security context defines the operating system security settings (uid, gid, capabilities, SELinux role, etc..) applied to a container. When designing your containers and pods, make sure that you configure the security context for your pods, containers, and volumes. A security context is a property defined in the deployment yaml. It controls the security parameters that will be assigned to the pod/container/volume.","remediation":"Follow the Kubernetes documentation and apply security contexts to your pods. For a suggested list of security contexts, you may refer to the CIS Security Benchmark for Docker Containers.\n**References**\nhttps://kubernetes.io/docs/concepts/policy/security-context/","complianceTags":"5.6.3","logicHash":"IESpWUCb45AmMIPF+zZBxA","severity":"Low"},"account":{"id":"5af13ab5-72ed-43b6-9544-33c9236d62f0","name":"nu-openshift-cluster","vendor":"Kubernetes","dome9CloudAccountId":"5af13ab5-72ed-43b6-9544-33c9236d62f0","organizationalUnitId":"00000000-0000-0000-0000-000000000000","organizationalUnitPath":""},"region":"Global","entity":{"spec":{"affinity":{"nodeAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":null,"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":null,"matchFields":[{"key":"metadata.name","operator":"In","values":["worker-1.demoenv.local"]}]}]}},"podAffinity":null,"podAntiAffinity":null},"containers":[{"args":["start"],"command":["/usr/bin/machine-config-daemon"],"env":[{"name":"NODE_NAME","value":null,"valueFrom":{"secretKeyRef":null}}],"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:9a00c3ca18cd9ce1a840fafb8657cea215a7bcb2ebc2078e23add75213779e3e","livenessProbe":null,"name":"machine-config-daemon","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:9a00c3ca18cd9ce1a840fafb8657cea215a7bcb2ebc2078e23add75213779e3e"},"parsedArgs":[{"key":"config-daemon","value":"start"}],"ports":null,"readinessProbe":null,"resources":{"limits":null,"requests":{"memory":"50Mi","cpu":"20m"}},"securityContext":{"allowPrivilegeEscalation":null,"capabilities":null,"privileged":true,"procMount":null,"readOnlyRootFilesystem":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"windowsOptions":null,"seccompProfile":null},"volumeMounts":[{"name":"rootfs","mountPath":"/rootfs","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"kube-api-access-x5xfd","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]},{"args":["--https-address=:9001","--provider=openshift","--openshift-service-account=machine-config-daemon","--upstream=http://127.0.0.1:8797","--tls-cert=/etc/tls/private/tls.crt","--tls-key=/etc/tls/private/tls.key","--cookie-secret-file=/etc/tls/cookie-secret/cookie-secret","--openshift-sar={\"resource\": \"namespaces\", \"verb\": \"get\"}","--openshift-delegate-urls={\"/\": {\"resource\": \"namespaces\", \"verb\": \"get\"}}"],"command":null,"env":null,"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:528e768b683ad82bf41a80e738c19fd43abb6d244c5b60fa24be966d4c9cd634","livenessProbe":null,"name":"oauth-proxy","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:528e768b683ad82bf41a80e738c19fd43abb6d244c5b60fa24be966d4c9cd634"},"parsedArgs":[{"key":"https-address","value":":9001"},{"key":"provider","value":"openshift"},{"key":"openshift-service-account","value":"machine-config-daemon"},{"key":"upstream","value":"http://127.0.0.1:8797"},{"key":"tls-cert","value":"/etc/tls/private/tls.crt"},{"key":"tls-key","value":"/etc/tls/private/tls.key"},{"key":"cookie-secret-file","value":"/etc/tls/cookie-secret/cookie-secret"},{"key":"openshift-sar","value":"{\"resource\": \"namespaces\", \"verb\": \"get\"}"},{"key":"openshift-delegate-urls","value":"{\"/\": {\"resource\": \"namespaces\", \"verb\": \"get\"}}"}],"ports":[{"containerPort":9001,"hostIP":null,"hostPort":9001,"name":"metrics","protocol":"TCP"}],"readinessProbe":null,"resources":{"limits":null,"requests":{"memory":"50Mi","cpu":"20m"}},"securityContext":null,"volumeMounts":[{"name":"proxy-tls","mountPath":"/etc/tls/private","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"cookie-secret","mountPath":"/etc/tls/cookie-secret","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"kube-api-access-x5xfd","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]}],"dnsConfig":null,"hostAliases":null,"hostIPC":false,"hostNetwork":true,"hostPID":true,"initContainers":null,"nodeInfo":{"conditions":[{"message":"kubelet has sufficient memory available","reason":"KubeletHasSufficientMemory","status":"False","type":"MemoryPressure"},{"message":"kubelet has no disk pressure","reason":"KubeletHasNoDiskPressure","status":"False","type":"DiskPressure"},{"message":"kubelet has sufficient PID available","reason":"KubeletHasSufficientPID","status":"False","type":"PIDPressure"},{"message":"kubelet is posting ready status","reason":"KubeletReady","status":"True","type":"Ready"}],"labels":[{"key":"beta.kubernetes.io/arch","value":"amd64"},{"key":"beta.kubernetes.io/os","value":"linux"},{"key":"kubernetes.io/arch","value":"amd64"},{"key":"kubernetes.io/hostname","value":"worker-1.demoenv.local"},{"key":"kubernetes.io/os","value":"linux"},{"key":"node-role.kubernetes.io/worker","value":""},{"key":"node.openshift.io/os_id","value":"rhcos"}]},"nodeName":"worker-1.demoenv.local","priority":2000001000,"priorityClassName":"system-node-critical","securityContext":{"fsGroup":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"supplementalGroups":null,"sysctls":null,"windowsOptions":null,"seccompProfile":null},"serviceAccount":"machine-config-daemon","serviceAccountName":"machine-config-daemon","tolerations":[{"key":null,"operator":"Exists","effect":null}],"volumes":[{"hostPath":{"path":"/","type":""},"flexVolume":null,"name":"rootfs","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"proxy-tls","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"cookie-secret","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"kube-api-access-x5xfd","persistentVolumeClaim":null}]},"status":{"phase":"Running","podIP":"192.168.10.16"},"networkPolicies":{"ingress":[],"egress":[]},"owner":{"ownerReferences":[{"kind":"DaemonSet","uid":"e8245204-fcdd-44a7-ae27-f6f16bcd2257","name":"machine-config-daemon"}],"rootOwner":{"kind":"DaemonSet","uid":"e8245204-fcdd-44a7-ae27-f6f16bcd2257","name":"machine-config-daemon"}},"tags":[{"key":"controller-revision-hash","value":"5fb4657656"},{"key":"k8s-app","value":"machine-config-daemon"},{"key":"pod-template-generation","value":"2"}],"namespace":"openshift-machine-config-operator","annotations":[{"key":"openshift.io/scc","value":"privileged"}],"labels":[{"key":"controller-revision-hash","value":"5fb4657656"},{"key":"k8s-app","value":"machine-config-daemon"},{"key":"pod-template-generation","value":"2"}],"creationTime":1671597545,"id":"11d79d3d-f106-4158-be77-f11811b4e5dc","type":"KubernetesPod","name":"machine-config-daemon-4r2d8","dome9Id":"11|5af13ab5-72ed-43b6-9544-33c9236d62f0|Pod|11d79d3d-f106-4158-be77-f11811b4e5dc","accountNumber":"5af13ab5-72ed-43b6-9544-33c9236d62f0","assetLabels":null,"region":"Global","externalFindings":null},"remediationActions":[],"action":"Detect","additionalFields":[]}