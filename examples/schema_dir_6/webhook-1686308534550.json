{"status":"Failed","policy":{"name":"Webhooks","description":""},"findingKey":"lvUW/u1GHl3k1D9n7FIcSg","findingId":"lvUW/u1GHl3k1D9n7FIcSg","cloudGuardAccountId":"51722","origin":"Compliance Engine","bundle":{"name":"CIS Kubernetes Benchmark v1.6.1","description":"Automated Validation of Kubernetes CIS Benchmark v1.6.1 Prescriptive guidance for establishing a secure configuration posture for Kubernetes 1.6.1\nFor additional reference: https://www.cisecurity.org/benchmark/kubernetes/","id":-70},"reportTime":"2023-06-09T11:00:31.243Z","rule":{"name":"Ensure that the seccomp profile is set to docker/default in your pod definitions","ruleId":"D9.K8S.IAM.21","description":"Seccomp (secure computing mode) is used to restrict the set of system calls applications can make, allowing cluster administrators greater control over the security of workloads running in the cluster. Kubernetes disables seccomp profiles by default for historical reasons. You should enable it to ensure that the workloads have restricted actions available within the container.","remediation":"Use security context to enable the docker/default seccomp profile in your pod definitions.\n\n**References**\n1. https://github.com/kubernetes/kubernetes/issues/39845\n2. https://github.com/kubernetes/kubernetes/pull/21790\n3. https://github.com/kubernetes/community/blob/master/contributors/design-proposals/seccomp.md#examples\n4. https://docs.docker.com/engine/security/seccomp/","complianceTags":"5.6.2","logicHash":"wat89y5RGQIVJriupbowlQ","severity":"High"},"account":{"id":"5af13ab5-72ed-43b6-9544-33c9236d62f0","name":"nu-openshift-cluster","vendor":"Kubernetes","dome9CloudAccountId":"5af13ab5-72ed-43b6-9544-33c9236d62f0","organizationalUnitId":"00000000-0000-0000-0000-000000000000","organizationalUnitPath":""},"region":"Global","entity":{"spec":{"affinity":{"nodeAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":null,"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":null,"matchFields":[{"key":"metadata.name","operator":"In","values":["worker-2.demoenv.local"]}]}]}},"podAffinity":null,"podAntiAffinity":null},"containers":[{"args":["--web.listen-address=127.0.0.1:9100","--path.sysfs=/host/sys","--path.rootfs=/host/root","--no-collector.wifi","--collector.filesystem.mount-points-exclude=^/(dev|proc|sys|run/k3s/containerd/.+|var/lib/docker/.+|var/lib/kubelet/pods/.+)($|/)","--collector.netclass.ignored-devices=^(veth.*|[a-f0-9]{15})$","--collector.netdev.device-exclude=^(veth.*|[a-f0-9]{15})$","--collector.cpu.info","--collector.textfile.directory=/var/node_exporter/textfile","--no-collector.cpufreq"],"command":null,"env":null,"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:9269c11895ed1312872040fa1477c0723bea8acf7384d446bc98ac089046bc47","livenessProbe":null,"name":"node-exporter","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:9269c11895ed1312872040fa1477c0723bea8acf7384d446bc98ac089046bc47"},"parsedArgs":[{"key":"web.listen-address","value":"127.0.0.1:9100"},{"key":"path.sysfs","value":"/host/sys"},{"key":"path.rootfs","value":"/host/root"},{"key":"collector.filesystem.mount-points-exclude","value":"^/(dev|proc|sys|run/k3s/containerd/.+|var/lib/docker/.+|var/lib/kubelet/pods/.+)($|/)"},{"key":"collector.netclass.ignored-devices","value":"^(veth.*|[a-f0-9]{15})$"},{"key":"collector.netdev.device-exclude","value":"^(veth.*|[a-f0-9]{15})$"},{"key":"collector.textfile.directory","value":"/var/node_exporter/textfile"}],"ports":null,"readinessProbe":null,"resources":{"limits":null,"requests":{"memory":"32Mi","cpu":"8m"}},"securityContext":{"allowPrivilegeEscalation":null,"capabilities":null,"privileged":null,"procMount":null,"readOnlyRootFilesystem":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"windowsOptions":null,"seccompProfile":null},"volumeMounts":[{"name":"sys","mountPath":"/host/sys","readOnly":true,"mountPropagation":"HostToContainer","subPath":null,"subPathExpr":null},{"name":"root","mountPath":"/host/root","readOnly":true,"mountPropagation":"HostToContainer","subPath":null,"subPathExpr":null},{"name":"node-exporter-textfile","mountPath":"/var/node_exporter/textfile","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"kube-api-access-vbl24","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]},{"args":["--logtostderr","--secure-listen-address=[$(IP)]:9100","--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256","--upstream=http://127.0.0.1:9100/","--tls-cert-file=/etc/tls/private/tls.crt","--tls-private-key-file=/etc/tls/private/tls.key","--client-ca-file=/etc/tls/client/client-ca.crt","--config-file=/etc/kube-rbac-policy/config.yaml","--tls-min-version=VersionTLS12"],"command":null,"env":[{"name":"IP","value":null,"valueFrom":{"secretKeyRef":null}}],"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:9d9c95c485abf0c842ec6f7b0c82e05176b3f8351fe840ae5ffa4d91f0100fb7","livenessProbe":null,"name":"kube-rbac-proxy","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:9d9c95c485abf0c842ec6f7b0c82e05176b3f8351fe840ae5ffa4d91f0100fb7"},"parsedArgs":[{"key":"secure-listen-address","value":"[$(IP)]:9100"},{"key":"tls-cipher-suites","value":"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256"},{"key":"upstream","value":"http://127.0.0.1:9100/"},{"key":"tls-cert-file","value":"/etc/tls/private/tls.crt"},{"key":"tls-private-key-file","value":"/etc/tls/private/tls.key"},{"key":"client-ca-file","value":"/etc/tls/client/client-ca.crt"},{"key":"config-file","value":"/etc/kube-rbac-policy/config.yaml"},{"key":"tls-min-version","value":"VersionTLS12"}],"ports":[{"containerPort":9100,"hostIP":null,"hostPort":9100,"name":"https","protocol":"TCP"}],"readinessProbe":null,"resources":{"limits":null,"requests":{"memory":"15Mi","cpu":"1m"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"add":null,"drop":["ALL"]},"privileged":null,"procMount":null,"readOnlyRootFilesystem":true,"runAsGroup":65532,"runAsNonRoot":true,"runAsUser":65532,"seLinuxOptions":null,"windowsOptions":null,"seccompProfile":null},"volumeMounts":[{"name":"node-exporter-tls","mountPath":"/etc/tls/private","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"metrics-client-ca","mountPath":"/etc/tls/client","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"node-exporter-kube-rbac-proxy-config","mountPath":"/etc/kube-rbac-policy","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"kube-api-access-vbl24","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]}],"dnsConfig":null,"hostAliases":null,"hostIPC":false,"hostNetwork":true,"hostPID":true,"initContainers":[{"args":null,"command":["/bin/sh","-c","[[ ! -d /node_exporter/collectors/init ]] || find /node_exporter/collectors/init -perm /111 -type f -exec {} \\;"],"env":[{"name":"TMPDIR","value":"/tmp","valueFrom":null}],"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:9269c11895ed1312872040fa1477c0723bea8acf7384d446bc98ac089046bc47","livenessProbe":null,"name":"init-textfile","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:9269c11895ed1312872040fa1477c0723bea8acf7384d446bc98ac089046bc47"},"parsedArgs":[{"key":"c","value":"[[ !"},{"key":"d","value":"/node_exporter/collectors/init ]] || find /node_exporter/collectors/init"},{"key":"perm","value":"/111"},{"key":"type","value":"f"},{"key":"exec","value":"{} \\;"}],"ports":null,"readinessProbe":null,"resources":{"limits":null,"requests":{"memory":"1Mi","cpu":"1m"}},"securityContext":{"allowPrivilegeEscalation":null,"capabilities":null,"privileged":true,"procMount":null,"readOnlyRootFilesystem":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":0,"seLinuxOptions":null,"windowsOptions":null,"seccompProfile":null},"volumeMounts":[{"name":"node-exporter-textfile","mountPath":"/var/node_exporter/textfile","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"node-exporter-wtmp","mountPath":"/var/log/wtmp","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"kube-api-access-vbl24","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]}],"nodeInfo":{"conditions":[{"message":"kubelet has sufficient memory available","reason":"KubeletHasSufficientMemory","status":"False","type":"MemoryPressure"},{"message":"kubelet has no disk pressure","reason":"KubeletHasNoDiskPressure","status":"False","type":"DiskPressure"},{"message":"kubelet has sufficient PID available","reason":"KubeletHasSufficientPID","status":"False","type":"PIDPressure"},{"message":"kubelet is posting ready status","reason":"KubeletReady","status":"True","type":"Ready"}],"labels":[{"key":"beta.kubernetes.io/arch","value":"amd64"},{"key":"beta.kubernetes.io/os","value":"linux"},{"key":"kubernetes.io/arch","value":"amd64"},{"key":"kubernetes.io/hostname","value":"worker-2.demoenv.local"},{"key":"kubernetes.io/os","value":"linux"},{"key":"node-role.kubernetes.io/worker","value":""},{"key":"node.openshift.io/os_id","value":"rhcos"}]},"nodeName":"worker-2.demoenv.local","priority":2000000000,"priorityClassName":"system-cluster-critical","securityContext":{"fsGroup":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"supplementalGroups":null,"sysctls":null,"windowsOptions":null,"seccompProfile":null},"serviceAccount":"node-exporter","serviceAccountName":"node-exporter","tolerations":[{"key":null,"operator":"Exists","effect":null}],"volumes":[{"hostPath":{"path":"/sys","type":""},"flexVolume":null,"name":"sys","persistentVolumeClaim":null},{"hostPath":{"path":"/","type":""},"flexVolume":null,"name":"root","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"node-exporter-textfile","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"node-exporter-tls","persistentVolumeClaim":null},{"hostPath":{"path":"/var/log/wtmp","type":"File"},"flexVolume":null,"name":"node-exporter-wtmp","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"metrics-client-ca","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"node-exporter-kube-rbac-proxy-config","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"kube-api-access-vbl24","persistentVolumeClaim":null}]},"status":{"phase":"Running","podIP":"192.168.10.15"},"networkPolicies":{"ingress":[],"egress":[]},"owner":{"ownerReferences":[{"kind":"DaemonSet","uid":"8d56d592-d9e3-4adf-a160-7692630c55c1","name":"node-exporter"}],"rootOwner":{"kind":"DaemonSet","uid":"8d56d592-d9e3-4adf-a160-7692630c55c1","name":"node-exporter"}},"tags":[{"key":"app.kubernetes.io/component","value":"exporter"},{"key":"app.kubernetes.io/managed-by","value":"cluster-monitoring-operator"},{"key":"app.kubernetes.io/name","value":"node-exporter"},{"key":"app.kubernetes.io/part-of","value":"openshift-monitoring"},{"key":"app.kubernetes.io/version","value":"1.3.1"},{"key":"controller-revision-hash","value":"c64489454"},{"key":"pod-template-generation","value":"2"}],"namespace":"openshift-monitoring","annotations":[{"key":"kubectl.kubernetes.io/default-container","value":"node-exporter"},{"key":"openshift.io/scc","value":"node-exporter"}],"labels":[{"key":"app.kubernetes.io/component","value":"exporter"},{"key":"app.kubernetes.io/managed-by","value":"cluster-monitoring-operator"},{"key":"app.kubernetes.io/name","value":"node-exporter"},{"key":"app.kubernetes.io/part-of","value":"openshift-monitoring"},{"key":"app.kubernetes.io/version","value":"1.3.1"},{"key":"controller-revision-hash","value":"c64489454"},{"key":"pod-template-generation","value":"2"}],"creationTime":1671596759,"id":"11c3b140-d0d2-416b-ac25-e506e856abd7","type":"KubernetesPod","name":"node-exporter-nzmc8","dome9Id":"11|5af13ab5-72ed-43b6-9544-33c9236d62f0|Pod|11c3b140-d0d2-416b-ac25-e506e856abd7","accountNumber":"5af13ab5-72ed-43b6-9544-33c9236d62f0","assetLabels":null,"region":"Global","externalFindings":null},"remediationActions":[],"action":"Detect","additionalFields":[]}