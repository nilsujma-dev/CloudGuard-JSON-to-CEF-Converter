{"status":"Failed","policy":{"name":"Webhooks","description":""},"findingKey":"6DFZlA29yKu0QR3lAhgxZQ","findingId":"6DFZlA29yKu0QR3lAhgxZQ","cloudGuardAccountId":"51722","origin":"Compliance Engine","bundle":{"name":"CIS Kubernetes Benchmark v1.6.1","description":"Automated Validation of Kubernetes CIS Benchmark v1.6.1 Prescriptive guidance for establishing a secure configuration posture for Kubernetes 1.6.1\nFor additional reference: https://www.cisecurity.org/benchmark/kubernetes/","id":-70},"reportTime":"2023-06-09T11:00:31.243Z","rule":{"name":"Ensure that the seccomp profile is set to docker/default in your pod definitions","ruleId":"D9.K8S.IAM.21","description":"Seccomp (secure computing mode) is used to restrict the set of system calls applications can make, allowing cluster administrators greater control over the security of workloads running in the cluster. Kubernetes disables seccomp profiles by default for historical reasons. You should enable it to ensure that the workloads have restricted actions available within the container.","remediation":"Use security context to enable the docker/default seccomp profile in your pod definitions.\n\n**References**\n1. https://github.com/kubernetes/kubernetes/issues/39845\n2. https://github.com/kubernetes/kubernetes/pull/21790\n3. https://github.com/kubernetes/community/blob/master/contributors/design-proposals/seccomp.md#examples\n4. https://docs.docker.com/engine/security/seccomp/","complianceTags":"5.6.2","logicHash":"wat89y5RGQIVJriupbowlQ","severity":"High"},"account":{"id":"5af13ab5-72ed-43b6-9544-33c9236d62f0","name":"nu-openshift-cluster","vendor":"Kubernetes","dome9CloudAccountId":"5af13ab5-72ed-43b6-9544-33c9236d62f0","organizationalUnitId":"00000000-0000-0000-0000-000000000000","organizationalUnitPath":""},"region":"Global","entity":{"spec":{"affinity":{"nodeAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":null,"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":null,"matchFields":[{"key":"metadata.name","operator":"In","values":["worker-3.demoenv.local"]}]}]}},"podAffinity":null,"podAntiAffinity":null},"containers":[{"args":["run-config","-d","/etc/checkpoint/cpsba/awl_config_dome9.json"],"command":null,"env":[{"name":"LANG","value":"C.UTF-8","valueFrom":null},{"name":"SBA_TELEMETRY_SAVE_TO_FILE","value":"1","valueFrom":null},{"name":"SBA_CONTAINER_RUNTIME","value":"cri-o","valueFrom":null},{"name":"SBA_USE_DOME9_FORWARDER","value":"1","valueFrom":null},{"name":"SBA_FORWARDER_AGENT_VERSION","value":"1.6.2","valueFrom":null},{"name":"TELEMETRY_VERSION","value":"0.0.4","valueFrom":null},{"name":"CP_KUBERNETES_DOME9_URL","value":"api-cpx.eu1.dome9.com","valueFrom":null},{"name":"CP_KUBERNETES_RUNTIME_ALERT_URI","value":"/runtimeevent/alert","valueFrom":null},{"name":"CP_KUBERNETES_RUNTIME_PROFILING_URI","value":"/runtimeevent/profiling","valueFrom":null},{"name":"CP_KUBERNETES_METRIC_URI","value":"/agenttelemetry","valueFrom":null},{"name":"CP_KUBERNETES_RUNTIME_TELEMETRY_URI","value":"/runtimetelemetry","valueFrom":null},{"name":"POD_ID","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"SYSDIG_BPF_PROBE","value":"/sysdig/.scap/scap-bpf.o","valueFrom":null},{"name":"SBA_USE_NETFILTER_QUEUE","value":"1","valueFrom":null},{"name":"DOME9_URL","value":"https://api-cpx.eu1.dome9.com","valueFrom":null},{"name":"CP_KUBERNETES_CLUSTER_ID","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"NAMESPACE_NAME","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"NODE_NAME","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"PLATFORM","value":"openshift","valueFrom":null}],"image":"quay.io/checkpoint/consec-runtime-daemon:1.6.2","livenessProbe":null,"name":"daemon","imageDetails":{"registry":"quay.io/checkpoint","repository":"consec-runtime-daemon","tag":"1.6.2"},"parsedArgs":[{"key":"d","value":"/etc/checkpoint/cpsba/awl_config_dome9.json"}],"ports":null,"readinessProbe":null,"resources":{"limits":{"memory":"800Mi","cpu":"400m"},"requests":{"memory":"300Mi","cpu":"200m"}},"securityContext":{"allowPrivilegeEscalation":null,"capabilities":null,"privileged":true,"procMount":null,"readOnlyRootFilesystem":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"windowsOptions":null,"seccompProfile":null},"volumeMounts":[{"name":"rp4c-alerts","mountPath":"/rp4c/alerts","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"rp4c-profiling","mountPath":"/rp4c/profiling","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"rp4c-metric","mountPath":"/rp4c/metric","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"metrics-tail","mountPath":"/metric-tail","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"rp4c-telemetry","mountPath":"/rp4c/telemetry","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"secret-volume","mountPath":"/etc/secret-volume","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"crio-sock","mountPath":"/var/run/crio/crio.sock","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"criofs-vol","mountPath":"/var/lib/containers/storage","readOnly":true,"mountPropagation":"HostToContainer","subPath":null,"subPathExpr":null},{"name":"criohooks-vol","mountPath":"/etc/containers/oci/hooks.d/","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"host-proc-vol","mountPath":"/host/proc","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"sysdig-probe-vol","mountPath":"/sysdig","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"sys-vol","mountPath":"/sys/kernel/debug/","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"run-xtables-lock","mountPath":"/run/xtables.lock","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"crashdumps-vol","mountPath":"/var/log/checkpoint/cpla/crashdumps","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"kube-api-access-n5ps5","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]}],"dnsConfig":null,"hostAliases":null,"hostIPC":false,"hostNetwork":true,"hostPID":true,"initContainers":[{"args":["nsenter --mount=/proc/1/ns/mnt -- mount --make-shared /var/lib/containers/storage/overlay"],"command":["/bin/sh","-c","--"],"env":null,"image":"docker.io/library/alpine:3.16","livenessProbe":null,"name":"criofsfix","imageDetails":{"registry":"docker.io/library","repository":"alpine","tag":"3.16"},"parsedArgs":[{"key":"","value":"nsenter"},{"key":"mount","value":"/proc/1/ns/mnt"},{"key":"","value":"mount"},{"key":"make-shared","value":"/var/lib/containers/storage/overlay"}],"ports":null,"readinessProbe":null,"resources":{"limits":null,"requests":null},"securityContext":{"allowPrivilegeEscalation":null,"capabilities":null,"privileged":true,"procMount":null,"readOnlyRootFilesystem":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"windowsOptions":null,"seccompProfile":null},"volumeMounts":[{"name":"kube-api-access-n5ps5","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]},{"args":null,"command":null,"env":[{"name":"HOME","value":"/sysdig","valueFrom":null},{"name":"SYSDIG_BPF_PROBE","value":null,"valueFrom":null},{"name":"SYSDIG_WAIT_FOR_KERNEL_SOURCE_TIMEOUT","value":"1800","valueFrom":null},{"name":"DOME9_URL","value":"https://api-cpx.eu1.dome9.com","valueFrom":null},{"name":"CP_KUBERNETES_CLUSTER_ID","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"NAMESPACE_NAME","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"NODE_NAME","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"PLATFORM","value":"openshift","valueFrom":null}],"image":"quay.io/checkpoint/consec-runtime-probe:0.30.2-cp-3","livenessProbe":null,"name":"probe","imageDetails":{"registry":"quay.io/checkpoint","repository":"consec-runtime-probe","tag":"0.30.2-cp-3"},"parsedArgs":[],"ports":null,"readinessProbe":null,"resources":{"limits":{"memory":"800Mi","cpu":"400m"},"requests":{"memory":"128Mi","cpu":"100m"}},"securityContext":{"allowPrivilegeEscalation":null,"capabilities":null,"privileged":true,"procMount":null,"readOnlyRootFilesystem":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"windowsOptions":null,"seccompProfile":null},"volumeMounts":[{"name":"boot-vol","mountPath":"/host/boot","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"modules-vol","mountPath":"/host/lib/modules","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"usr-vol","mountPath":"/host/usr","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"host-etc-vol","mountPath":"/host/etc","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"sysdig-probe-vol","mountPath":"/sysdig","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"kube-api-access-n5ps5","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]}],"nodeInfo":{"conditions":[{"message":"kubelet has sufficient memory available","reason":"KubeletHasSufficientMemory","status":"False","type":"MemoryPressure"},{"message":"kubelet has no disk pressure","reason":"KubeletHasNoDiskPressure","status":"False","type":"DiskPressure"},{"message":"kubelet has sufficient PID available","reason":"KubeletHasSufficientPID","status":"False","type":"PIDPressure"},{"message":"kubelet is posting ready status","reason":"KubeletReady","status":"True","type":"Ready"}],"labels":[{"key":"beta.kubernetes.io/arch","value":"amd64"},{"key":"beta.kubernetes.io/os","value":"linux"},{"key":"kubernetes.io/arch","value":"amd64"},{"key":"kubernetes.io/hostname","value":"worker-3.demoenv.local"},{"key":"kubernetes.io/os","value":"linux"},{"key":"node-role.kubernetes.io/worker","value":""},{"key":"node.openshift.io/os_id","value":"rhcos"}]},"nodeName":"worker-3.demoenv.local","priority":0,"priorityClassName":null,"securityContext":{"fsGroup":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"supplementalGroups":null,"sysctls":null,"windowsOptions":null,"seccompProfile":null},"serviceAccount":"asset-mgmt-runtime-daemon","serviceAccountName":"asset-mgmt-runtime-daemon","tolerations":[{"key":null,"operator":"Exists","effect":null}],"volumes":[{"hostPath":null,"flexVolume":null,"name":"rp4c-alerts","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"rp4c-profiling","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"rp4c-metric","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"metrics-tail","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"rp4c-telemetry","persistentVolumeClaim":null},{"hostPath":{"path":"/var/run/crio/crio.sock","type":"Socket"},"flexVolume":null,"name":"crio-sock","persistentVolumeClaim":null},{"hostPath":{"path":"/var/lib/containers/storage","type":""},"flexVolume":null,"name":"criofs-vol","persistentVolumeClaim":null},{"hostPath":{"path":"/etc/containers/oci/hooks.d/","type":""},"flexVolume":null,"name":"criohooks-vol","persistentVolumeClaim":null},{"hostPath":{"path":"/boot","type":""},"flexVolume":null,"name":"boot-vol","persistentVolumeClaim":null},{"hostPath":{"path":"/lib/modules","type":""},"flexVolume":null,"name":"modules-vol","persistentVolumeClaim":null},{"hostPath":{"path":"/usr","type":""},"flexVolume":null,"name":"usr-vol","persistentVolumeClaim":null},{"hostPath":{"path":"/proc","type":""},"flexVolume":null,"name":"host-proc-vol","persistentVolumeClaim":null},{"hostPath":{"path":"/var/local","type":""},"flexVolume":null,"name":"sysdig-probe-vol","persistentVolumeClaim":null},{"hostPath":{"path":"/sys/kernel/debug/","type":""},"flexVolume":null,"name":"sys-vol","persistentVolumeClaim":null},{"hostPath":{"path":"/etc","type":""},"flexVolume":null,"name":"host-etc-vol","persistentVolumeClaim":null},{"hostPath":{"path":"/run/xtables.lock","type":""},"flexVolume":null,"name":"run-xtables-lock","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"crashdumps-vol","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"secret-volume","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"kube-api-access-n5ps5","persistentVolumeClaim":null}]},"status":{"phase":"Running","podIP":"192.168.10.14"},"networkPolicies":{"ingress":[],"egress":[]},"owner":{"ownerReferences":[{"kind":"DaemonSet","uid":"9f1b16bc-d328-4a30-8aa8-719877175239","name":"asset-mgmt-runtime-daemon"}],"rootOwner":{"kind":"DaemonSet","uid":"9f1b16bc-d328-4a30-8aa8-719877175239","name":"asset-mgmt-runtime-daemon"}},"tags":[{"key":"app.kubernetes.io/instance","value":"asset-mgmt"},{"key":"app.kubernetes.io/name","value":"asset-mgmt-runtime-daemon"},{"key":"controller-revision-hash","value":"695bb76c64"},{"key":"pod-template-generation","value":"1"}],"namespace":"checkpoint","annotations":[{"key":"container.apparmor.security.beta.kubernetes.io/daemon","value":"unconfined"},{"key":"openshift.io/scc","value":"privileged"}],"labels":[{"key":"app.kubernetes.io/instance","value":"asset-mgmt"},{"key":"app.kubernetes.io/name","value":"asset-mgmt-runtime-daemon"},{"key":"controller-revision-hash","value":"695bb76c64"},{"key":"pod-template-generation","value":"1"}],"creationTime":1680570401,"id":"30dd66a3-1617-419f-b658-53ddcc2e40df","type":"KubernetesPod","name":"asset-mgmt-runtime-daemon-gbf2t","dome9Id":"11|5af13ab5-72ed-43b6-9544-33c9236d62f0|Pod|30dd66a3-1617-419f-b658-53ddcc2e40df","accountNumber":"5af13ab5-72ed-43b6-9544-33c9236d62f0","assetLabels":null,"region":"Global","externalFindings":null},"remediationActions":[],"action":"Detect","additionalFields":[]}