{"status":"Failed","policy":{"name":"Webhooks","description":""},"findingKey":"majeRFSfAd+hehNperCzlA","findingId":"majeRFSfAd+hehNperCzlA","cloudGuardAccountId":"51722","origin":"Compliance Engine","bundle":{"name":"CIS Kubernetes Benchmark v1.6.1","description":"Automated Validation of Kubernetes CIS Benchmark v1.6.1 Prescriptive guidance for establishing a secure configuration posture for Kubernetes 1.6.1\nFor additional reference: https://www.cisecurity.org/benchmark/kubernetes/","id":-70},"reportTime":"2023-06-09T11:00:31.243Z","rule":{"name":"Ensure that the seccomp profile is set to docker/default in your pod definitions","ruleId":"D9.K8S.IAM.21","description":"Seccomp (secure computing mode) is used to restrict the set of system calls applications can make, allowing cluster administrators greater control over the security of workloads running in the cluster. Kubernetes disables seccomp profiles by default for historical reasons. You should enable it to ensure that the workloads have restricted actions available within the container.","remediation":"Use security context to enable the docker/default seccomp profile in your pod definitions.\n\n**References**\n1. https://github.com/kubernetes/kubernetes/issues/39845\n2. https://github.com/kubernetes/kubernetes/pull/21790\n3. https://github.com/kubernetes/community/blob/master/contributors/design-proposals/seccomp.md#examples\n4. https://docs.docker.com/engine/security/seccomp/","complianceTags":"5.6.2","logicHash":"wat89y5RGQIVJriupbowlQ","severity":"High"},"account":{"id":"5af13ab5-72ed-43b6-9544-33c9236d62f0","name":"nu-openshift-cluster","vendor":"Kubernetes","dome9CloudAccountId":"5af13ab5-72ed-43b6-9544-33c9236d62f0","organizationalUnitId":"00000000-0000-0000-0000-000000000000","organizationalUnitPath":""},"region":"Global","entity":{"spec":{"affinity":{"nodeAffinity":null,"podAffinity":null,"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":null,"requiredDuringSchedulingIgnoredDuringExecution":[{"labelSelector":{"matchLabels":{"app":"oauth-openshift","oauth-openshift-anti-affinity":"true"},"matchExpressions":null},"namespaces":null,"topologyKey":"kubernetes.io/hostname"}]}},"containers":[{"args":["if [ -s /var/config/system/configmaps/v4-0-config-system-trusted-ca-bundle/ca-bundle.crt ]; then\n    echo \"Copying system trust bundle\"\n    cp -f /var/config/system/configmaps/v4-0-config-system-trusted-ca-bundle/ca-bundle.crt /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\nfi\nexec oauth-server osinserver \\\n--config=/var/config/system/configmaps/v4-0-config-system-cliconfig/v4-0-config-system-cliconfig \\\n--v=2 \\\n--audit-log-format=json \\\n--audit-log-maxbackup=10 \\\n--audit-log-maxsize=100 \\\n--audit-log-path=/var/log/oauth-server/audit.log \\\n--audit-policy-file=/var/run/configmaps/audit/audit.yaml\n"],"command":["/bin/bash","-ec"],"env":null,"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:f5de341827c2b3cb2c63cdb2d3aeb4c5b2584b96bc796cff3ef2f3e2305521b4","livenessProbe":{"exec":null,"failureThreshold":3,"httpGet":{"host":null,"path":"/healthz","port":"6443","scheme":"HTTPS","httpHeaders":null},"initialDelaySeconds":30,"periodSeconds":10,"successThreshold":1,"tcpSocket":null,"timeoutSeconds":1},"name":"oauth-openshift","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:f5de341827c2b3cb2c63cdb2d3aeb4c5b2584b96bc796cff3ef2f3e2305521b4"},"parsedArgs":[{"key":"ec","value":"if ["},{"key":"s","value":"/var/config/system/configmaps/v4-0-config-system-trusted-ca-bundle/ca-bundle.crt ]; then    echo \"Copying system trust bundle\"    cp"},{"key":"f","value":"/var/config/system/configmaps/v4-0-config-system-trusted-ca-bundle/ca-bundle.crt /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pemfiexec oauth-server osinserver \\--config=/var/config/system/configmaps/v4-0-config-system-cliconfig/v4-0-config-system-cliconfig \\--v=2 \\--audit-log-format=json \\--audit-log-maxbackup=10 \\--audit-log-maxsize=100 \\--audit-log-path=/var/log/oauth-server/audit.log \\--audit-policy-file=/var/run/configmaps/audit/audit.yaml"}],"ports":[{"containerPort":6443,"hostIP":null,"hostPort":0,"name":"https","protocol":"TCP"}],"readinessProbe":{"exec":null,"failureThreshold":3,"httpGet":{"host":null,"path":"/healthz","port":"6443","scheme":"HTTPS","httpHeaders":null},"initialDelaySeconds":0,"periodSeconds":10,"successThreshold":1,"tcpSocket":null,"timeoutSeconds":1},"resources":{"limits":null,"requests":{"memory":"50Mi","cpu":"10m"}},"securityContext":{"allowPrivilegeEscalation":null,"capabilities":null,"privileged":true,"procMount":null,"readOnlyRootFilesystem":false,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":0,"seLinuxOptions":null,"windowsOptions":null,"seccompProfile":null},"volumeMounts":[{"name":"audit-policies","mountPath":"/var/run/configmaps/audit","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"audit-dir","mountPath":"/var/log/oauth-server","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"v4-0-config-system-session","mountPath":"/var/config/system/secrets/v4-0-config-system-session","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"v4-0-config-system-cliconfig","mountPath":"/var/config/system/configmaps/v4-0-config-system-cliconfig","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"v4-0-config-system-serving-cert","mountPath":"/var/config/system/secrets/v4-0-config-system-serving-cert","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"v4-0-config-system-service-ca","mountPath":"/var/config/system/configmaps/v4-0-config-system-service-ca","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"v4-0-config-system-router-certs","mountPath":"/var/config/system/secrets/v4-0-config-system-router-certs","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"v4-0-config-system-ocp-branding-template","mountPath":"/var/config/system/secrets/v4-0-config-system-ocp-branding-template","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"v4-0-config-user-template-login","mountPath":"/var/config/user/template/secret/v4-0-config-user-template-login","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"v4-0-config-user-template-provider-selection","mountPath":"/var/config/user/template/secret/v4-0-config-user-template-provider-selection","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"v4-0-config-user-template-error","mountPath":"/var/config/user/template/secret/v4-0-config-user-template-error","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"v4-0-config-system-trusted-ca-bundle","mountPath":"/var/config/system/configmaps/v4-0-config-system-trusted-ca-bundle","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"kube-api-access-27fbj","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]}],"dnsConfig":null,"hostAliases":null,"hostIPC":false,"hostNetwork":null,"hostPID":false,"initContainers":null,"nodeInfo":{"conditions":[{"message":"kubelet has sufficient memory available","reason":"KubeletHasSufficientMemory","status":"False","type":"MemoryPressure"},{"message":"kubelet has no disk pressure","reason":"KubeletHasNoDiskPressure","status":"False","type":"DiskPressure"},{"message":"kubelet has sufficient PID available","reason":"KubeletHasSufficientPID","status":"False","type":"PIDPressure"},{"message":"kubelet is posting ready status","reason":"KubeletReady","status":"True","type":"Ready"}],"labels":[{"key":"beta.kubernetes.io/arch","value":"amd64"},{"key":"beta.kubernetes.io/os","value":"linux"},{"key":"kubernetes.io/arch","value":"amd64"},{"key":"kubernetes.io/hostname","value":"control-2.demoenv.local"},{"key":"kubernetes.io/os","value":"linux"},{"key":"node-role.kubernetes.io/master","value":""},{"key":"node.openshift.io/os_id","value":"rhcos"}]},"nodeName":"control-2.demoenv.local","priority":2000000000,"priorityClassName":"system-cluster-critical","securityContext":{"fsGroup":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"supplementalGroups":null,"sysctls":null,"windowsOptions":null,"seccompProfile":null},"serviceAccount":"oauth-openshift","serviceAccountName":"oauth-openshift","tolerations":[{"key":"node-role.kubernetes.io/master","operator":"Exists","effect":"NoSchedule"},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute"},{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute"},{"key":"node.kubernetes.io/memory-pressure","operator":"Exists","effect":"NoSchedule"}],"volumes":[{"hostPath":null,"flexVolume":null,"name":"audit-policies","persistentVolumeClaim":null},{"hostPath":{"path":"/var/log/oauth-server","type":""},"flexVolume":null,"name":"audit-dir","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"v4-0-config-system-session","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"v4-0-config-system-cliconfig","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"v4-0-config-system-serving-cert","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"v4-0-config-system-service-ca","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"v4-0-config-system-router-certs","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"v4-0-config-system-ocp-branding-template","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"v4-0-config-user-template-login","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"v4-0-config-user-template-provider-selection","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"v4-0-config-user-template-error","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"v4-0-config-system-trusted-ca-bundle","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"kube-api-access-27fbj","persistentVolumeClaim":null}]},"status":{"phase":"Running","podIP":"10.129.1.167"},"networkPolicies":{"ingress":[],"egress":[]},"owner":{"ownerReferences":[{"kind":"ReplicaSet","uid":"cf19bb8c-0b67-41a2-a154-ee26d8368606","name":"oauth-openshift-77cdcb96f9"}],"rootOwner":{"kind":"Deployment","uid":"da097f9d-7159-4489-b6dc-a6fb22261a97","name":"oauth-openshift"}},"tags":[{"key":"app","value":"oauth-openshift"},{"key":"oauth-openshift-anti-affinity","value":"true"},{"key":"pod-template-hash","value":"77cdcb96f9"}],"namespace":"openshift-authentication","annotations":[{"key":"k8s.v1.cni.cncf.io/network-status","value":"[{\n    \"name\": \"openshift-sdn\",\n    \"interface\": \"eth0\",\n    \"ips\": [\n        \"10.129.1.167\"\n    ],\n    \"default\": true,\n    \"dns\": {}\n}]"},{"key":"k8s.v1.cni.cncf.io/networks-status","value":"[{\n    \"name\": \"openshift-sdn\",\n    \"interface\": \"eth0\",\n    \"ips\": [\n        \"10.129.1.167\"\n    ],\n    \"default\": true,\n    \"dns\": {}\n}]"},{"key":"openshift.io/scc","value":"node-exporter"},{"key":"operator.openshift.io/bootstrap-user-exists","value":"true"},{"key":"operator.openshift.io/rvs-hash","value":"9ql_u8ny-M3S-6HGaag6qUT2Kur5eIhFf6HN1LEeNeJA2AJkl0aycjuEbHR8Il7Re6ckR7Ei4wvNjYx4nWF3hQ"}],"labels":[{"key":"app","value":"oauth-openshift"},{"key":"oauth-openshift-anti-affinity","value":"true"},{"key":"pod-template-hash","value":"77cdcb96f9"}],"creationTime":1684161608,"id":"62a81422-8c16-4d8e-92a2-e22a21bf9727","type":"KubernetesPod","name":"oauth-openshift-77cdcb96f9-j2jvw","dome9Id":"11|5af13ab5-72ed-43b6-9544-33c9236d62f0|Pod|62a81422-8c16-4d8e-92a2-e22a21bf9727","accountNumber":"5af13ab5-72ed-43b6-9544-33c9236d62f0","assetLabels":null,"region":"Global","externalFindings":null},"remediationActions":[],"action":"Detect","additionalFields":[]}