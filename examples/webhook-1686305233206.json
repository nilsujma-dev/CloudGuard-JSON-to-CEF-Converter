{"status":"Failed","policy":{"name":"Webhooks","description":""},"findingKey":"mr+WGKbNWd7GQGXgpvfNCw","findingId":"mr+WGKbNWd7GQGXgpvfNCw","cloudGuardAccountId":"51722","origin":"Compliance Engine","bundle":{"name":"GCP CloudGuard Best Practices","description":"CloudGuard Best Practices for securing GCP Account","id":-9},"reportTime":"2023-06-09T09:04:54.86Z","rule":{"name":"Ensure VPC Flow logs is enabled for every subnet in a VPC Network","ruleId":"D9.GCP.NET.16","description":"Flow Logs is a feature that enables you to capture information about the IP traffic going to\nand from network interfaces in your VPC Subnets. After you've created a flow log, you can\nview and retrieve its data in Stackdriver Logging. It is recommended that Flow Logs be\nenabled for every business critical VPC subnet.\nFlow Logs provide visibility into network traffic for each VM inside the subnet and can be\nused to detect anomalous traffic or insight during security workflows.","remediation":"\n**From Portal**\n1. Go to VPC network GCP Console visiting https://console.cloud.google.com/networking/networks/list\n2. Click the name of a subnet, The Subnet details page is displayed\n3. Click on EDIT button\n4. Set Flow Logs to On\n5. Expand the Configure Logs section.\n6. Set Aggregation Interval to 5 SEC.\n7. Check the box beside Include metadata.\n8. Set Sample rate to 100.\n9. Click Save.\n\n\n**From TF**\n```\nresource 'google_compute_subnetwork' 'subnetwork' {\n\nlog_config {\naggregation_interval = 'INTERVAL_10_MIN'\nflow_sampling        = 0.5\nmetadata             = 'INCLUDE_ALL_METADATA'\n}\n}\n```\n\n**From Command Line**\nRun\n```\ngcloud compute networks subnets update [SUBNET_NAME] --region [REGION] --enable-flow-logs --logging-aggregation-interval=interval-5-sec --logging-flow-sampling=1 --logging-metadata=include-all\n\n```\n\n**References**\n1. https://cloud.google.com/vpc/docs/using-flow-logs#enabling_vpc_flow_logging\n2. https://cloud.google.com/vpc/\n","complianceTags":"Network Security","logicHash":"iPJ1kGZzQt8svkXFtJFHyg","severity":"Medium"},"account":{"id":"serious-conduit-389105","name":"GCP Demo Account NU","vendor":"GCP","dome9CloudAccountId":"ca5ef528-d8dd-41d8-a022-1a820a6adb60","organizationalUnitId":"00000000-0000-0000-0000-000000000000","organizationalUnitPath":""},"region":"europe-west3","entity":{"description":null,"gatewayAddress":"10.156.0.1","ipCidrRange":"10.156.0.0/20","network":"default","networkData":{"autoCreateSubnetworks":true,"description":"Default network for the project","gatewayIPv4":null,"iPv4Range":null,"name":"default","dome9Id":"8|ca5ef528-d8dd-41d8-a022-1a820a6adb60|Network|default","selfLink":"https://www.googleapis.com/compute/beta/projects/serious-conduit-389105/global/networks/default"},"fingerPrint":"zlc19BjUvKE=","allowSubnetCidrRoutesOverlap":false,"enableFlowLogs":null,"privateIpGoogleAccess":false,"secondaryIpRanges":[],"resourceType":"Local","selfLink":"https://www.googleapis.com/compute/beta/projects/serious-conduit-389105/regions/europe-west3/subnetworks/default","id":"7037095826454064426","type":"Subnet","name":"default","dome9Id":"8|ca5ef528-d8dd-41d8-a022-1a820a6adb60|Region|europe-west3|Subnet|default","accountNumber":"serious-conduit-389105","assetLabels":null,"region":"europe-west3","externalFindings":null},"remediationActions":[],"action":"Detect","additionalFields":[]}