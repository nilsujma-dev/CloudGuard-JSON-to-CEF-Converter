{"status":"Failed","policy":{"name":"Webhooks","description":""},"findingKey":"34MhNz5oLgOgy0/PobpA+A","findingId":"34MhNz5oLgOgy0/PobpA+A","cloudGuardAccountId":"51722","origin":"Compliance Engine","bundle":{"name":"CIS Kubernetes Benchmark v1.6.1","description":"Automated Validation of Kubernetes CIS Benchmark v1.6.1 Prescriptive guidance for establishing a secure configuration posture for Kubernetes 1.6.1\nFor additional reference: https://www.cisecurity.org/benchmark/kubernetes/","id":-70},"reportTime":"2023-06-09T11:00:31.243Z","rule":{"name":"Ensure that the seccomp profile is set to docker/default in your pod definitions","ruleId":"D9.K8S.IAM.21","description":"Seccomp (secure computing mode) is used to restrict the set of system calls applications can make, allowing cluster administrators greater control over the security of workloads running in the cluster. Kubernetes disables seccomp profiles by default for historical reasons. You should enable it to ensure that the workloads have restricted actions available within the container.","remediation":"Use security context to enable the docker/default seccomp profile in your pod definitions.\n\n**References**\n1. https://github.com/kubernetes/kubernetes/issues/39845\n2. https://github.com/kubernetes/kubernetes/pull/21790\n3. https://github.com/kubernetes/community/blob/master/contributors/design-proposals/seccomp.md#examples\n4. https://docs.docker.com/engine/security/seccomp/","complianceTags":"5.6.2","logicHash":"wat89y5RGQIVJriupbowlQ","severity":"High"},"account":{"id":"5af13ab5-72ed-43b6-9544-33c9236d62f0","name":"nu-openshift-cluster","vendor":"Kubernetes","dome9CloudAccountId":"5af13ab5-72ed-43b6-9544-33c9236d62f0","organizationalUnitId":"00000000-0000-0000-0000-000000000000","organizationalUnitPath":""},"region":"Global","entity":{"spec":{"affinity":{"nodeAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":null,"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":null,"matchFields":[{"key":"metadata.name","operator":"In","values":["worker-1.demoenv.local"]}]}]}},"podAffinity":null,"podAntiAffinity":null},"containers":[{"args":null,"command":["/node_agent"],"env":[{"name":"DOME9_URL","value":"https://api-cpx.eu1.dome9.com","valueFrom":null},{"name":"CP_KUBERNETES_CLUSTER_ID","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"NAMESPACE_NAME","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"NODE_NAME","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"PLATFORM","value":"openshift","valueFrom":null},{"name":"USE_SHIM","value":"true","valueFrom":null}],"image":"quay.io/checkpoint/consec-imagescan-daemon:2.21.0","livenessProbe":null,"name":"daemon","imageDetails":{"registry":"quay.io/checkpoint","repository":"consec-imagescan-daemon","tag":"2.21.0"},"parsedArgs":[],"ports":[{"containerPort":8443,"hostIP":null,"hostPort":0,"name":null,"protocol":"TCP"}],"readinessProbe":null,"resources":{"limits":{"memory":"50Mi","cpu":"50m"},"requests":{"memory":"50Mi","cpu":"50m"}},"securityContext":{"allowPrivilegeEscalation":null,"capabilities":null,"privileged":true,"procMount":null,"readOnlyRootFilesystem":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"windowsOptions":null,"seccompProfile":null},"volumeMounts":[{"name":"secret-volume","mountPath":"/etc/secret-volume","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"serverkey-volume","mountPath":"/etc/serverkey","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"servercert-volume","mountPath":"/etc/servercert","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"clientcert-volume","mountPath":"/etc/clientcert","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"kube-api-access-vxclb","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]},{"args":null,"command":["/shim"],"env":[{"name":"DOME9_URL","value":"https://api-cpx.eu1.dome9.com","valueFrom":null},{"name":"CP_KUBERNETES_CLUSTER_ID","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"NAMESPACE_NAME","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"NODE_NAME","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"PLATFORM","value":"openshift","valueFrom":null},{"name":"LD_LIBRARY_PATH","value":"/lib/x86_64-linux-gnu:/lib64:/usr/lib/x86_64-linux-gnu","valueFrom":null}],"image":"quay.io/checkpoint/consec-imagescan-shim:2.21.0","livenessProbe":null,"name":"shim","imageDetails":{"registry":"quay.io/checkpoint","repository":"consec-imagescan-shim","tag":"2.21.0"},"parsedArgs":[],"ports":null,"readinessProbe":null,"resources":{"limits":{"memory":"150Mi","cpu":"200m"},"requests":{"memory":"150Mi","cpu":"100m"}},"securityContext":{"allowPrivilegeEscalation":null,"capabilities":null,"privileged":true,"procMount":null,"readOnlyRootFilesystem":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"windowsOptions":null,"seccompProfile":null},"volumeMounts":[{"name":"secret-volume","mountPath":"/etc/secret-volume","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"cri-sock-volume","mountPath":"/run/cri.sock","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"etc-containers","mountPath":"/etc/containers","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"run-containers","mountPath":"/run/containers","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"var-lib-containers","mountPath":"/var/lib/containers","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"lib64","mountPath":"/lib64","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"podman","mountPath":"/usr/bin/podman","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"conmon","mountPath":"/usr/bin/conmon","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"runc","mountPath":"/usr/bin/runc","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"nsenter","mountPath":"/usr/bin/nsenter","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"kube-api-access-vxclb","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]}],"dnsConfig":null,"hostAliases":null,"hostIPC":false,"hostNetwork":null,"hostPID":false,"initContainers":null,"nodeInfo":{"conditions":[{"message":"kubelet has sufficient memory available","reason":"KubeletHasSufficientMemory","status":"False","type":"MemoryPressure"},{"message":"kubelet has no disk pressure","reason":"KubeletHasNoDiskPressure","status":"False","type":"DiskPressure"},{"message":"kubelet has sufficient PID available","reason":"KubeletHasSufficientPID","status":"False","type":"PIDPressure"},{"message":"kubelet is posting ready status","reason":"KubeletReady","status":"True","type":"Ready"}],"labels":[{"key":"beta.kubernetes.io/arch","value":"amd64"},{"key":"beta.kubernetes.io/os","value":"linux"},{"key":"kubernetes.io/arch","value":"amd64"},{"key":"kubernetes.io/hostname","value":"worker-1.demoenv.local"},{"key":"kubernetes.io/os","value":"linux"},{"key":"node-role.kubernetes.io/worker","value":""},{"key":"node.openshift.io/os_id","value":"rhcos"}]},"nodeName":"worker-1.demoenv.local","priority":0,"priorityClassName":null,"securityContext":{"fsGroup":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"supplementalGroups":null,"sysctls":null,"windowsOptions":null,"seccompProfile":null},"serviceAccount":"asset-mgmt-imagescan-daemon","serviceAccountName":"asset-mgmt-imagescan-daemon","tolerations":[{"key":null,"operator":"Exists","effect":null}],"volumes":[{"hostPath":null,"flexVolume":null,"name":"secret-volume","persistentVolumeClaim":null},{"hostPath":{"path":"/run/crio/crio.sock","type":"Socket"},"flexVolume":null,"name":"cri-sock-volume","persistentVolumeClaim":null},{"hostPath":{"path":"/etc/containers","type":"Directory"},"flexVolume":null,"name":"etc-containers","persistentVolumeClaim":null},{"hostPath":{"path":"/run/containers","type":"Directory"},"flexVolume":null,"name":"run-containers","persistentVolumeClaim":null},{"hostPath":{"path":"/var/lib/containers","type":"Directory"},"flexVolume":null,"name":"var-lib-containers","persistentVolumeClaim":null},{"hostPath":{"path":"/lib64","type":"Directory"},"flexVolume":null,"name":"lib64","persistentVolumeClaim":null},{"hostPath":{"path":"/usr/bin/podman","type":"File"},"flexVolume":null,"name":"podman","persistentVolumeClaim":null},{"hostPath":{"path":"/usr/bin/conmon","type":"File"},"flexVolume":null,"name":"conmon","persistentVolumeClaim":null},{"hostPath":{"path":"/usr/bin/runc","type":"File"},"flexVolume":null,"name":"runc","persistentVolumeClaim":null},{"hostPath":{"path":"/usr/bin/nsenter","type":"File"},"flexVolume":null,"name":"nsenter","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"serverkey-volume","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"servercert-volume","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"clientcert-volume","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"kube-api-access-vxclb","persistentVolumeClaim":null}]},"status":{"phase":"Running","podIP":"10.128.2.4"},"networkPolicies":{"ingress":[],"egress":[]},"owner":{"ownerReferences":[{"kind":"DaemonSet","uid":"16f3a1b3-9eff-4d70-a953-a2429ee9d4f9","name":"asset-mgmt-imagescan-daemon"}],"rootOwner":{"kind":"DaemonSet","uid":"16f3a1b3-9eff-4d70-a953-a2429ee9d4f9","name":"asset-mgmt-imagescan-daemon"}},"tags":[{"key":"app.kubernetes.io/instance","value":"asset-mgmt"},{"key":"app.kubernetes.io/name","value":"asset-mgmt-imagescan-daemon"},{"key":"controller-revision-hash","value":"7d9f8dcbfb"},{"key":"pod-template-generation","value":"1"}],"namespace":"checkpoint","annotations":[{"key":"k8s.v1.cni.cncf.io/network-status","value":"[{\n    \"name\": \"openshift-sdn\",\n    \"interface\": \"eth0\",\n    \"ips\": [\n        \"10.128.2.4\"\n    ],\n    \"default\": true,\n    \"dns\": {}\n}]"},{"key":"k8s.v1.cni.cncf.io/networks-status","value":"[{\n    \"name\": \"openshift-sdn\",\n    \"interface\": \"eth0\",\n    \"ips\": [\n        \"10.128.2.4\"\n    ],\n    \"default\": true,\n    \"dns\": {}\n}]"},{"key":"openshift.io/scc","value":"privileged"},{"key":"timestamp","value":"2023-04-04 01:06:33.935090861 +0000 UTC m=+6.638986624"}],"labels":[{"key":"app.kubernetes.io/instance","value":"asset-mgmt"},{"key":"app.kubernetes.io/name","value":"asset-mgmt-imagescan-daemon"},{"key":"controller-revision-hash","value":"7d9f8dcbfb"},{"key":"pod-template-generation","value":"1"}],"creationTime":1680579200,"id":"166383f2-d056-43d4-8e09-0379c6c8b064","type":"KubernetesPod","name":"asset-mgmt-imagescan-daemon-k24mj","dome9Id":"11|5af13ab5-72ed-43b6-9544-33c9236d62f0|Pod|166383f2-d056-43d4-8e09-0379c6c8b064","accountNumber":"5af13ab5-72ed-43b6-9544-33c9236d62f0","assetLabels":null,"region":"Global","externalFindings":null},"remediationActions":[],"action":"Detect","additionalFields":[]}