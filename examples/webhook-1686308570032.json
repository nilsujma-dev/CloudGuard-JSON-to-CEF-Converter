{"status":"Failed","policy":{"name":"Webhooks","description":""},"findingKey":"SEmZoG7qebswiztcO5refQ","findingId":"SEmZoG7qebswiztcO5refQ","cloudGuardAccountId":"51722","origin":"Compliance Engine","bundle":{"name":"CIS Kubernetes Benchmark v1.6.1","description":"Automated Validation of Kubernetes CIS Benchmark v1.6.1 Prescriptive guidance for establishing a secure configuration posture for Kubernetes 1.6.1\nFor additional reference: https://www.cisecurity.org/benchmark/kubernetes/","id":-70},"reportTime":"2023-06-09T11:00:31.243Z","rule":{"name":"Apply Security Context to Your Pods and Containers","ruleId":"D9.K8S.OPE.06","description":"Apply Security Context to Your Pods and Containers. A security context defines the operating system security settings (uid, gid, capabilities, SELinux role, etc..) applied to a container. When designing your containers and pods, make sure that you configure the security context for your pods, containers, and volumes. A security context is a property defined in the deployment yaml. It controls the security parameters that will be assigned to the pod/container/volume.","remediation":"Follow the Kubernetes documentation and apply security contexts to your pods. For a suggested list of security contexts, you may refer to the CIS Security Benchmark for Docker Containers.\n**References**\nhttps://kubernetes.io/docs/concepts/policy/security-context/","complianceTags":"5.6.3","logicHash":"IESpWUCb45AmMIPF+zZBxA","severity":"Low"},"account":{"id":"5af13ab5-72ed-43b6-9544-33c9236d62f0","name":"nu-openshift-cluster","vendor":"Kubernetes","dome9CloudAccountId":"5af13ab5-72ed-43b6-9544-33c9236d62f0","organizationalUnitId":"00000000-0000-0000-0000-000000000000","organizationalUnitPath":""},"region":"Global","entity":{"spec":{"affinity":{"nodeAffinity":null,"podAffinity":null,"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":null,"requiredDuringSchedulingIgnoredDuringExecution":[{"labelSelector":{"matchLabels":{"apiserver":"true","app":"openshift-apiserver-a","openshift-apiserver-anti-affinity":"true"},"matchExpressions":null},"namespaces":null,"topologyKey":"kubernetes.io/hostname"}]}},"containers":[{"args":["if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\n  echo \"Copying system trust bundle\"\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\nfi\nexec openshift-apiserver start --config=/var/run/configmaps/config/config.yaml -v=2\n"],"command":["/bin/bash","-ec"],"env":[{"name":"POD_NAME","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"POD_NAMESPACE","value":null,"valueFrom":{"secretKeyRef":null}}],"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:38d0a9755e915ba29f9d394eaa7bc4f313a399157c2348edaaafe890997bd509","livenessProbe":{"exec":null,"failureThreshold":3,"httpGet":{"host":null,"path":"healthz","port":"8443","scheme":"HTTPS","httpHeaders":null},"initialDelaySeconds":0,"periodSeconds":10,"successThreshold":1,"tcpSocket":null,"timeoutSeconds":1},"name":"openshift-apiserver","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:38d0a9755e915ba29f9d394eaa7bc4f313a399157c2348edaaafe890997bd509"},"parsedArgs":[{"key":"ec","value":"if ["},{"key":"s","value":"/var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then  echo \"Copying system trust bundle\"  cp"},{"key":"f","value":"/var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pemfiexec openshift-apiserver start"},{"key":"config","value":"/var/run/configmaps/config/config.yaml"},{"key":"v","value":"2"}],"ports":[{"containerPort":8443,"hostIP":null,"hostPort":0,"name":null,"protocol":"TCP"}],"readinessProbe":{"exec":null,"failureThreshold":1,"httpGet":{"host":null,"path":"readyz","port":"8443","scheme":"HTTPS","httpHeaders":null},"initialDelaySeconds":0,"periodSeconds":5,"successThreshold":1,"tcpSocket":null,"timeoutSeconds":1},"resources":{"limits":null,"requests":{"memory":"200Mi","cpu":"100m"}},"securityContext":{"allowPrivilegeEscalation":null,"capabilities":null,"privileged":true,"procMount":null,"readOnlyRootFilesystem":false,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":0,"seLinuxOptions":null,"windowsOptions":null,"seccompProfile":null},"volumeMounts":[{"name":"node-pullsecrets","mountPath":"/var/lib/kubelet/","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"config","mountPath":"/var/run/configmaps/config","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"audit","mountPath":"/var/run/configmaps/audit","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"etcd-client","mountPath":"/var/run/secrets/etcd-client","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"etcd-serving-ca","mountPath":"/var/run/configmaps/etcd-serving-ca","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"image-import-ca","mountPath":"/var/run/configmaps/image-import-ca","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"trusted-ca-bundle","mountPath":"/var/run/configmaps/trusted-ca-bundle","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"serving-cert","mountPath":"/var/run/secrets/serving-cert","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"encryption-config","mountPath":"/var/run/secrets/encryption-config","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"audit-dir","mountPath":"/var/log/openshift-apiserver","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"kube-api-access-7klc8","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]},{"args":["--listen","0.0.0.0:17698","--namespace","$(POD_NAMESPACE)","--v","2"],"command":["cluster-kube-apiserver-operator","check-endpoints"],"env":[{"name":"POD_NAME","value":null,"valueFrom":{"secretKeyRef":null}},{"name":"POD_NAMESPACE","value":null,"valueFrom":{"secretKeyRef":null}}],"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:3ba4b4f00df0329a9a84a848b4289f2cb2ee3aed069de92f7fae4f0928b35082","livenessProbe":null,"name":"openshift-apiserver-check-endpoints","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:3ba4b4f00df0329a9a84a848b4289f2cb2ee3aed069de92f7fae4f0928b35082"},"parsedArgs":[{"key":"kube-apiserver-operator","value":"check-endpoints"},{"key":"listen","value":"0.0.0.0:17698"},{"key":"namespace","value":"$(POD_NAMESPACE)"},{"key":"v","value":"2"}],"ports":[{"containerPort":17698,"hostIP":null,"hostPort":0,"name":"check-endpoints","protocol":"TCP"}],"readinessProbe":null,"resources":{"limits":null,"requests":{"memory":"50Mi","cpu":"10m"}},"securityContext":null,"volumeMounts":[{"name":"kube-api-access-7klc8","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]}],"dnsConfig":null,"hostAliases":null,"hostIPC":false,"hostNetwork":null,"hostPID":false,"initContainers":[{"args":null,"command":["sh","-c","chmod 0700 /var/log/openshift-apiserver && touch /var/log/openshift-apiserver/audit.log && chmod 0600 /var/log/openshift-apiserver/*"],"env":null,"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:38d0a9755e915ba29f9d394eaa7bc4f313a399157c2348edaaafe890997bd509","livenessProbe":null,"name":"fix-audit-permissions","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:38d0a9755e915ba29f9d394eaa7bc4f313a399157c2348edaaafe890997bd509"},"parsedArgs":[{"key":"c","value":"chmod 0700 /var/log/openshift-apiserver && touch /var/log/openshift-apiserver/audit.log && chmod 0600 /var/log/openshift-apiserver/*"}],"ports":null,"readinessProbe":null,"resources":{"limits":null,"requests":{"memory":"50Mi","cpu":"15m"}},"securityContext":{"allowPrivilegeEscalation":null,"capabilities":null,"privileged":true,"procMount":null,"readOnlyRootFilesystem":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":0,"seLinuxOptions":null,"windowsOptions":null,"seccompProfile":null},"volumeMounts":[{"name":"audit-dir","mountPath":"/var/log/openshift-apiserver","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"kube-api-access-7klc8","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]}],"nodeInfo":{"conditions":[{"message":"kubelet has sufficient memory available","reason":"KubeletHasSufficientMemory","status":"False","type":"MemoryPressure"},{"message":"kubelet has no disk pressure","reason":"KubeletHasNoDiskPressure","status":"False","type":"DiskPressure"},{"message":"kubelet has sufficient PID available","reason":"KubeletHasSufficientPID","status":"False","type":"PIDPressure"},{"message":"kubelet is posting ready status","reason":"KubeletReady","status":"True","type":"Ready"}],"labels":[{"key":"beta.kubernetes.io/arch","value":"amd64"},{"key":"beta.kubernetes.io/os","value":"linux"},{"key":"kubernetes.io/arch","value":"amd64"},{"key":"kubernetes.io/hostname","value":"control-1.demoenv.local"},{"key":"kubernetes.io/os","value":"linux"},{"key":"node-role.kubernetes.io/master","value":""},{"key":"node.openshift.io/os_id","value":"rhcos"}]},"nodeName":"control-1.demoenv.local","priority":2000001000,"priorityClassName":"system-node-critical","securityContext":{"fsGroup":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"supplementalGroups":null,"sysctls":null,"windowsOptions":null,"seccompProfile":null},"serviceAccount":"openshift-apiserver-sa","serviceAccountName":"openshift-apiserver-sa","tolerations":[{"key":"node-role.kubernetes.io/master","operator":"Exists","effect":"NoSchedule"},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute"},{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute"},{"key":"node.kubernetes.io/memory-pressure","operator":"Exists","effect":"NoSchedule"}],"volumes":[{"hostPath":{"path":"/var/lib/kubelet/","type":"Directory"},"flexVolume":null,"name":"node-pullsecrets","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"config","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"audit","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"etcd-client","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"etcd-serving-ca","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"image-import-ca","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"serving-cert","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"trusted-ca-bundle","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"encryption-config","persistentVolumeClaim":null},{"hostPath":{"path":"/var/log/openshift-apiserver","type":""},"flexVolume":null,"name":"audit-dir","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"kube-api-access-7klc8","persistentVolumeClaim":null}]},"status":{"phase":"Running","podIP":"10.128.0.16"},"networkPolicies":{"ingress":[],"egress":[]},"owner":{"ownerReferences":[{"kind":"ReplicaSet","uid":"dab5c2e5-dfc8-4691-a751-8c50074927bf","name":"apiserver-5d6658b444"}],"rootOwner":{"kind":"Deployment","uid":"e804bdcf-557f-4a0a-8a23-0dd5c62818b7","name":"apiserver"}},"tags":[{"key":"apiserver","value":"true"},{"key":"app","value":"openshift-apiserver-a"},{"key":"openshift-apiserver-anti-affinity","value":"true"},{"key":"pod-template-hash","value":"5d6658b444"},{"key":"revision","value":"1"}],"namespace":"openshift-apiserver","annotations":[{"key":"k8s.v1.cni.cncf.io/network-status","value":"[{\n    \"name\": \"openshift-sdn\",\n    \"interface\": \"eth0\",\n    \"ips\": [\n        \"10.128.0.16\"\n    ],\n    \"default\": true,\n    \"dns\": {}\n}]"},{"key":"k8s.v1.cni.cncf.io/networks-status","value":"[{\n    \"name\": \"openshift-sdn\",\n    \"interface\": \"eth0\",\n    \"ips\": [\n        \"10.128.0.16\"\n    ],\n    \"default\": true,\n    \"dns\": {}\n}]"},{"key":"openshift.io/scc","value":"node-exporter"},{"key":"operator.openshift.io/dep-desired.generation","value":"5"},{"key":"operator.openshift.io/dep-openshift-apiserver.config.configmap","value":"epfFXg=="},{"key":"operator.openshift.io/dep-openshift-apiserver.etcd-client.secret","value":"ZDLjcA=="},{"key":"operator.openshift.io/dep-openshift-apiserver.etcd-serving-ca.configmap","value":"vjbB9g=="},{"key":"operator.openshift.io/dep-openshift-apiserver.image-import-ca.configmap","value":"OUXnWA=="},{"key":"operator.openshift.io/dep-openshift-apiserver.trusted-ca-bundle.configmap","value":"O1lK1A=="}],"labels":[{"key":"apiserver","value":"true"},{"key":"app","value":"openshift-apiserver-a"},{"key":"openshift-apiserver-anti-affinity","value":"true"},{"key":"pod-template-hash","value":"5d6658b444"},{"key":"revision","value":"1"}],"creationTime":1671598123,"id":"d7065fd7-5383-41d2-a0d4-afc5a372c5f1","type":"KubernetesPod","name":"apiserver-5d6658b444-lfpth","dome9Id":"11|5af13ab5-72ed-43b6-9544-33c9236d62f0|Pod|d7065fd7-5383-41d2-a0d4-afc5a372c5f1","accountNumber":"5af13ab5-72ed-43b6-9544-33c9236d62f0","assetLabels":null,"region":"Global","externalFindings":null},"remediationActions":[],"action":"Detect","additionalFields":[]}