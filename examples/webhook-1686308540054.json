{"status":"Failed","policy":{"name":"Webhooks","description":""},"findingKey":"mljggdhroxMHxKHHqhyp/Q","findingId":"mljggdhroxMHxKHHqhyp/Q","cloudGuardAccountId":"51722","origin":"Compliance Engine","bundle":{"name":"CIS Kubernetes Benchmark v1.6.1","description":"Automated Validation of Kubernetes CIS Benchmark v1.6.1 Prescriptive guidance for establishing a secure configuration posture for Kubernetes 1.6.1\nFor additional reference: https://www.cisecurity.org/benchmark/kubernetes/","id":-70},"reportTime":"2023-06-09T11:00:31.243Z","rule":{"name":"Ensure that the seccomp profile is set to docker/default in your pod definitions","ruleId":"D9.K8S.IAM.21","description":"Seccomp (secure computing mode) is used to restrict the set of system calls applications can make, allowing cluster administrators greater control over the security of workloads running in the cluster. Kubernetes disables seccomp profiles by default for historical reasons. You should enable it to ensure that the workloads have restricted actions available within the container.","remediation":"Use security context to enable the docker/default seccomp profile in your pod definitions.\n\n**References**\n1. https://github.com/kubernetes/kubernetes/issues/39845\n2. https://github.com/kubernetes/kubernetes/pull/21790\n3. https://github.com/kubernetes/community/blob/master/contributors/design-proposals/seccomp.md#examples\n4. https://docs.docker.com/engine/security/seccomp/","complianceTags":"5.6.2","logicHash":"wat89y5RGQIVJriupbowlQ","severity":"High"},"account":{"id":"5af13ab5-72ed-43b6-9544-33c9236d62f0","name":"nu-openshift-cluster","vendor":"Kubernetes","dome9CloudAccountId":"5af13ab5-72ed-43b6-9544-33c9236d62f0","organizationalUnitId":"00000000-0000-0000-0000-000000000000","organizationalUnitPath":""},"region":"Global","entity":{"spec":{"affinity":null,"containers":[{"args":["--secure-listen-address=0.0.0.0:9192","--upstream=http://127.0.0.1:9191/","--tls-cert-file=/etc/tls/private/tls.crt","--tls-private-key-file=/etc/tls/private/tls.key","--config-file=/etc/kube-rbac-proxy/config-file.yaml","--tls-cipher-suites=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305","--logtostderr=true","--v=3"],"command":null,"env":null,"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:9d9c95c485abf0c842ec6f7b0c82e05176b3f8351fe840ae5ffa4d91f0100fb7","livenessProbe":null,"name":"kube-rbac-proxy","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:9d9c95c485abf0c842ec6f7b0c82e05176b3f8351fe840ae5ffa4d91f0100fb7"},"parsedArgs":[{"key":"secure-listen-address","value":"0.0.0.0:9192"},{"key":"upstream","value":"http://127.0.0.1:9191/"},{"key":"tls-cert-file","value":"/etc/tls/private/tls.crt"},{"key":"tls-private-key-file","value":"/etc/tls/private/tls.key"},{"key":"config-file","value":"/etc/kube-rbac-proxy/config-file.yaml"},{"key":"tls-cipher-suites","value":"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305"},{"key":"logtostderr","value":"true"},{"key":"v","value":"3"}],"ports":[{"containerPort":9192,"hostIP":null,"hostPort":9192,"name":"https","protocol":"TCP"}],"readinessProbe":null,"resources":{"limits":null,"requests":{"memory":"20Mi","cpu":"10m"}},"securityContext":null,"volumeMounts":[{"name":"auth-proxy-config","mountPath":"/etc/kube-rbac-proxy","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"machine-approver-tls","mountPath":"/etc/tls/private","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"kube-api-access-htxb2","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]},{"args":["--config=/var/run/configmaps/config/config.yaml","-v=2","--logtostderr","--leader-elect=true","--leader-elect-lease-duration=137s","--leader-elect-renew-deadline=107s","--leader-elect-retry-period=26s","--leader-elect-resource-namespace=openshift-cluster-machine-approver","--api-group-version=machine.openshift.io/v1beta1"],"command":["/usr/bin/machine-approver"],"env":[{"name":"RELEASE_VERSION","value":"4.11.18","valueFrom":null},{"name":"METRICS_PORT","value":"9191","valueFrom":null}],"image":"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:83b71b04c5f7dd786bea8b48cd9a6da6ef1186f40251af9bf0d8846335282107","livenessProbe":null,"name":"machine-approver-controller","imageDetails":{"registry":"quay.io/openshift-release-dev","repository":"ocp-v4.0-art-dev","tag":"sha256:83b71b04c5f7dd786bea8b48cd9a6da6ef1186f40251af9bf0d8846335282107"},"parsedArgs":[{"key":"config","value":"/var/run/configmaps/config/config.yaml"},{"key":"v","value":"2"},{"key":"leader-elect","value":"true"},{"key":"leader-elect-lease-duration","value":"137s"},{"key":"leader-elect-renew-deadline","value":"107s"},{"key":"leader-elect-retry-period","value":"26s"},{"key":"leader-elect-resource-namespace","value":"openshift-cluster-machine-approver"},{"key":"api-group-version","value":"machine.openshift.io/v1beta1"}],"ports":null,"readinessProbe":null,"resources":{"limits":null,"requests":{"memory":"50Mi","cpu":"10m"}},"securityContext":null,"volumeMounts":[{"name":"config","mountPath":"/var/run/configmaps/config","readOnly":false,"mountPropagation":null,"subPath":null,"subPathExpr":null},{"name":"kube-api-access-htxb2","mountPath":"/var/run/secrets/kubernetes.io/serviceaccount","readOnly":true,"mountPropagation":null,"subPath":null,"subPathExpr":null}]}],"dnsConfig":null,"hostAliases":null,"hostIPC":false,"hostNetwork":true,"hostPID":false,"initContainers":null,"nodeInfo":{"conditions":[{"message":"kubelet has sufficient memory available","reason":"KubeletHasSufficientMemory","status":"False","type":"MemoryPressure"},{"message":"kubelet has no disk pressure","reason":"KubeletHasNoDiskPressure","status":"False","type":"DiskPressure"},{"message":"kubelet has sufficient PID available","reason":"KubeletHasSufficientPID","status":"False","type":"PIDPressure"},{"message":"kubelet is posting ready status","reason":"KubeletReady","status":"True","type":"Ready"}],"labels":[{"key":"beta.kubernetes.io/arch","value":"amd64"},{"key":"beta.kubernetes.io/os","value":"linux"},{"key":"kubernetes.io/arch","value":"amd64"},{"key":"kubernetes.io/hostname","value":"control-3.demoenv.local"},{"key":"kubernetes.io/os","value":"linux"},{"key":"node-role.kubernetes.io/master","value":""},{"key":"node.openshift.io/os_id","value":"rhcos"}]},"nodeName":"control-3.demoenv.local","priority":2000000000,"priorityClassName":"system-cluster-critical","securityContext":{"fsGroup":null,"runAsGroup":null,"runAsNonRoot":null,"runAsUser":null,"seLinuxOptions":null,"supplementalGroups":null,"sysctls":null,"windowsOptions":null,"seccompProfile":null},"serviceAccount":"machine-approver-sa","serviceAccountName":"machine-approver-sa","tolerations":[{"key":"node-role.kubernetes.io/master","operator":"Exists","effect":"NoSchedule"},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute"},{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute"},{"key":"node.kubernetes.io/memory-pressure","operator":"Exists","effect":"NoSchedule"}],"volumes":[{"hostPath":null,"flexVolume":null,"name":"auth-proxy-config","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"machine-approver-tls","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"config","persistentVolumeClaim":null},{"hostPath":null,"flexVolume":null,"name":"kube-api-access-htxb2","persistentVolumeClaim":null}]},"status":{"phase":"Running","podIP":"192.168.10.13"},"networkPolicies":{"ingress":[],"egress":[]},"owner":{"ownerReferences":[{"kind":"ReplicaSet","uid":"7cffcb2b-fa3b-4af9-9cbf-7dc43c524ba3","name":"machine-approver-8d9f9876d"}],"rootOwner":{"kind":"Deployment","uid":"7d9fe812-ddb3-4eee-b7d9-823d672dec21","name":"machine-approver"}},"tags":[{"key":"app","value":"machine-approver"},{"key":"pod-template-hash","value":"8d9f9876d"}],"namespace":"openshift-cluster-machine-approver","annotations":[],"labels":[{"key":"app","value":"machine-approver"},{"key":"pod-template-hash","value":"8d9f9876d"}],"creationTime":1680570337,"id":"32c562be-3ef3-44df-bb77-b454b7d6cb1a","type":"KubernetesPod","name":"machine-approver-8d9f9876d-t4ltp","dome9Id":"11|5af13ab5-72ed-43b6-9544-33c9236d62f0|Pod|32c562be-3ef3-44df-bb77-b454b7d6cb1a","accountNumber":"5af13ab5-72ed-43b6-9544-33c9236d62f0","assetLabels":null,"region":"Global","externalFindings":null},"remediationActions":[],"action":"Detect","additionalFields":[]}