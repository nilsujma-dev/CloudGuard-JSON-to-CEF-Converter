{"status":"Failed","policy":{"name":"Webhooks","description":""},"findingKey":"6yQoRQztEmHH6ePiI2JkLQ","findingId":"6yQoRQztEmHH6ePiI2JkLQ","cloudGuardAccountId":"51722","origin":"Compliance Engine","bundle":{"name":"GCP CloudGuard Best Practices","description":"CloudGuard Best Practices for securing GCP Account","id":-9},"reportTime":"2023-06-09T09:04:54.86Z","rule":{"name":"Ensure that RDP access is restricted from the internet","ruleId":"D9.GCP.NET.13","description":"GCP Firewall Rules are specific to a VPC Network. Each rule either allows or denies traffic when its conditions are met. Its conditions allow you to specify the type of traffic, such as ports and protocols, and the source or destination of the traffic, including IP addresses, subnets, and instances. Firewall rules are defined at the VPC network level, and are specific to the network in which they are defined. The rules themselves cannot be shared among networks. Firewall rules only support IPv4 traffic. When specifying a source for an ingress rule or a destination for an egress rule by address, you can only use an IPv4 address or IPv4 block in CIDR notation. Generic (0.0.0.0/0) incoming traffic from internet to VPC or VM instance using RDP on Port 3389 can be avoided.","remediation":"\n**From Portal**\n1. Go to VPC Network.\n2. Go to the Firewall Rules.\n3. Click the Firewall Rule you want to modify.\n4. Click Edit.\n5. Modify Source IP ranges to specific IP.\n6. Click Save.\n\n**From TF**\nSet deny bucket to be equal to protocol:tcp, port:3389:\n```\nresource 'google_compute_firewall' 'default' {\n...\ndeny {\nprotocol = 'tcp'\nports    = ['3389']\n}\n...\n}\n```\n\n**From Command Line**\nRun\n```\ngcloud compute firewall-rules update FIREWALL_NAME --rules=PROTOCOL:PORT-PORT\n```\n\n**References**\n1. https://cloud.google.com/vpc/docs/firewalls#default_firewall_rules\n2. https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall\n","complianceTags":"Network Security","logicHash":"1hkXWeXTcN2vGUEKlR17jg","severity":"High"},"account":{"id":"serious-conduit-389105","name":"GCP Demo Account NU","vendor":"GCP","dome9CloudAccountId":"ca5ef528-d8dd-41d8-a022-1a820a6adb60","organizationalUnitId":"00000000-0000-0000-0000-000000000000","organizationalUnitPath":""},"region":"Global","entity":{"network":"default","inboundRules":[{"description":"Allow ICMP from anywhere","enabled":true,"name":"default-allow-icmp","number":65534,"protocol":"ICMP","source":"0.0.0.0/0","destination":"0.0.0.0/0","destinationPort":0,"destinationPortTo":0,"direction":"INBOUND","action":"ALLOW"},{"description":"Allow SSH from anywhere","enabled":true,"name":"default-allow-ssh","number":65534,"protocol":"TCP","source":"0.0.0.0/0","destination":"0.0.0.0/0","destinationPort":22,"destinationPortTo":22,"direction":"INBOUND","action":"ALLOW"},{"description":"Allow internal traffic on the default network","enabled":true,"name":"default-allow-internal","number":65534,"protocol":"TCP","source":"10.128.0.0/9","destination":"0.0.0.0/0","destinationPort":0,"destinationPortTo":65535,"direction":"INBOUND","action":"ALLOW"},{"description":"Allow internal traffic on the default network","enabled":true,"name":"default-allow-internal","number":65534,"protocol":"UDP","source":"10.128.0.0/9","destination":"0.0.0.0/0","destinationPort":0,"destinationPortTo":65535,"direction":"INBOUND","action":"ALLOW"},{"description":"Allow internal traffic on the default network","enabled":true,"name":"default-allow-internal","number":65534,"protocol":"ICMP","source":"10.128.0.0/9","destination":"0.0.0.0/0","destinationPort":0,"destinationPortTo":0,"direction":"INBOUND","action":"ALLOW"},{"description":"Allow RDP from anywhere","enabled":true,"name":"default-allow-rdp","number":65534,"protocol":"TCP","source":"0.0.0.0/0","destination":"0.0.0.0/0","destinationPort":3389,"destinationPortTo":3389,"direction":"INBOUND","action":"ALLOW"}],"outboundRules":[],"vmInstances":[],"resourceType":"Local","selfLink":null,"id":"serious-conduit-389105|default|global","type":"GcpSecurityGroup","name":"Global","dome9Id":"8|ca5ef528-d8dd-41d8-a022-1a820a6adb60|SecurityGroup|serious-conduit-389105|default|global","accountNumber":"serious-conduit-389105","assetLabels":null,"region":"Global","externalFindings":null},"remediationActions":[],"action":"Detect","additionalFields":[]}