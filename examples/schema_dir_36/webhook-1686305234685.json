{"status":"Failed","policy":{"name":"Webhooks","description":""},"findingKey":"Q32a2KsU12FmR9WBLxc8eA","findingId":"Q32a2KsU12FmR9WBLxc8eA","cloudGuardAccountId":"51722","origin":"Compliance Engine","bundle":{"name":"GCP CloudGuard Best Practices","description":"CloudGuard Best Practices for securing GCP Account","id":-9},"reportTime":"2023-06-09T09:04:54.86Z","rule":{"name":"Ensure Global Firewall rule should not allows all traffic","ruleId":"D9.GCP.NET.07","description":"Firewall Rules that are applied to all the VM instances - 'Global' should not allow protocol='TCP' and source = '0.0.0.0/0' ","remediation":"\n**From Portal**\n1. Go to VPC network.\n2. Go to the Firewall Rules.\n3. Select the relevant Firewall Rule and click on Edit.\n3. Ensure Port is not equal to 22 and Action is not Allow.\n4. Under Source ranges ensure IP Ranges is not equal to 0.0.0.0 .\n\n\n**From Command Line**\nNote : If you need to change the name, network, or the action or direction component, you must delete the rule and create a new one instead.\n\n1. To update exist firewall rules, run:\n```\ngcloud compute firewall-rules update FIREWALL_NAME --source-ranges=CIDR_RANGE --rules=[PROTOCOL[:PORT]\n```\n2. To delete firewall rules, run:\n```\ngcloud compute firewall-rules delete [FIREWALL_NAME]\n```\n3. To create new firewall rules, run:\n```\ngcloud compute firewall-rules create FIREWALL_NAME\n[--priority=PRIORITY] \n[--description=DESCRIPTION] \n[--target-tags=TAG,...] \n[--target-service-accounts=IAM_SERVICE_ACCOUNT,_] \n[--source-ranges=CIDR_RANGE,...] \n[--source-tags=TAG,...] \n[--source-service-accounts=IAM_SERVICE_ACCOUNT,_] \n[--destination-ranges=CIDR_RANGE,...] \n[--rules=[JHY[:88[-88]],...]] \n[--disabled | --no-disabled] \n[--enable-logging | --no-enable-logging]\n```\n\n**From TF**\n```\nresource \"google_compute_firewall\" \"allow-ssh\" {\nname = \"global\"\nallow {\n-   protocol = \"tcp\"\n}\n- source_ranges = [\"0.0.0.0/0\"]\n}\n```\n\n**References**\n1. https://cloud.google.com/vpc/docs/firewalls#blockedtraffic\n2. https://cloud.google.com/vpc/docs/using-firewalls\n","complianceTags":"Network Security","logicHash":"pPkl2a1+LTaeRiQY8jK+iA","severity":"High"},"account":{"id":"serious-conduit-389105","name":"GCP Demo Account NU","vendor":"GCP","dome9CloudAccountId":"ca5ef528-d8dd-41d8-a022-1a820a6adb60","organizationalUnitId":"00000000-0000-0000-0000-000000000000","organizationalUnitPath":""},"region":"Global","entity":{"network":"default","inboundRules":[{"description":"Allow ICMP from anywhere","enabled":true,"name":"default-allow-icmp","number":65534,"protocol":"ICMP","source":"0.0.0.0/0","destination":"0.0.0.0/0","destinationPort":0,"destinationPortTo":0,"direction":"INBOUND","action":"ALLOW"},{"description":"Allow SSH from anywhere","enabled":true,"name":"default-allow-ssh","number":65534,"protocol":"TCP","source":"0.0.0.0/0","destination":"0.0.0.0/0","destinationPort":22,"destinationPortTo":22,"direction":"INBOUND","action":"ALLOW"},{"description":"Allow internal traffic on the default network","enabled":true,"name":"default-allow-internal","number":65534,"protocol":"TCP","source":"10.128.0.0/9","destination":"0.0.0.0/0","destinationPort":0,"destinationPortTo":65535,"direction":"INBOUND","action":"ALLOW"},{"description":"Allow internal traffic on the default network","enabled":true,"name":"default-allow-internal","number":65534,"protocol":"UDP","source":"10.128.0.0/9","destination":"0.0.0.0/0","destinationPort":0,"destinationPortTo":65535,"direction":"INBOUND","action":"ALLOW"},{"description":"Allow internal traffic on the default network","enabled":true,"name":"default-allow-internal","number":65534,"protocol":"ICMP","source":"10.128.0.0/9","destination":"0.0.0.0/0","destinationPort":0,"destinationPortTo":0,"direction":"INBOUND","action":"ALLOW"},{"description":"Allow RDP from anywhere","enabled":true,"name":"default-allow-rdp","number":65534,"protocol":"TCP","source":"0.0.0.0/0","destination":"0.0.0.0/0","destinationPort":3389,"destinationPortTo":3389,"direction":"INBOUND","action":"ALLOW"}],"outboundRules":[],"vmInstances":[],"resourceType":"Local","selfLink":null,"id":"serious-conduit-389105|default|global","type":"GcpSecurityGroup","name":"Global","dome9Id":"8|ca5ef528-d8dd-41d8-a022-1a820a6adb60|SecurityGroup|serious-conduit-389105|default|global","accountNumber":"serious-conduit-389105","assetLabels":null,"region":"Global","externalFindings":null},"remediationActions":[],"action":"Detect","additionalFields":[]}