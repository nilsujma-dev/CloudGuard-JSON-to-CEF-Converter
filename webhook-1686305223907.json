{"status":"Failed","policy":{"name":"Webhooks","description":""},"findingKey":"feNvlodmvO8kA/mbXLRb2Q","findingId":"feNvlodmvO8kA/mbXLRb2Q","cloudGuardAccountId":"51722","origin":"Compliance Engine","bundle":{"name":"GCP CloudGuard Best Practices","description":"CloudGuard Best Practices for securing GCP Account","id":-9},"reportTime":"2023-06-09T09:04:54.86Z","rule":{"name":"Ensure oslogin is enabled for a Project","ruleId":"D9.GCP.CRY.03","description":"Enabling osLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user. It facilitates centralized and automated ssh key pair management which is useful in handling cases like response to compromised ssh key pairs and/or revocation of external/third-party/Vendor users.","remediation":"\n**From Portal**\n1. Go to the VM compute metadata page using https://console.cloud.google.com/compute/metadata?\n2. Click Edit.\n3. Add a metadata entry where the key is enable-oslogin and the value is TRUE.\n4. Click Save to apply the changes.\n\n**From TF**\nSet the enable-oslogin to true in metadata node:\n```\nresource 'google_compute_project_metadata' 'default' {\n..\nmetadata = {\nenable-oslogin = true\n}\n..\n}\n```\n\n**From Command Line**\nRun\n```\ngcloud compute project-info add-metadata --metadata enable-oslogin=TRUE\n```\n\n**References**\n1. https://cloud.google.com/compute/docs/storing-retrieving-metadata\n2. https://cloud.google.com/sdk/gcloud/reference/compute/project-info/add-metadata\n","complianceTags":"Encryption and Key Management","logicHash":"Xc6RopEaYTz9xyAlWKAuMQ","severity":"Medium"},"account":{"id":"serious-conduit-389105","name":"GCP Demo Account NU","vendor":"GCP","dome9CloudAccountId":"ca5ef528-d8dd-41d8-a022-1a820a6adb60","organizationalUnitId":"00000000-0000-0000-0000-000000000000","organizationalUnitPath":""},"region":"Global","entity":{"defaultServiceAccount":"554880214893-compute@developer.gserviceaccount.com","description":null,"enabledFeatures":null,"metadata":{"items":null,"eTag":null,"kind":"compute#metadata"},"sharedVpcHostProjectId":null,"enabledServices":[{"name":"logging.googleapis.com","title":"Cloud Logging API"},{"name":"autoscaling.googleapis.com","title":"Cloud Autoscaling API"},{"name":"cloudtrace.googleapis.com","title":"Cloud Trace API"},{"name":"bigquery.googleapis.com","title":"BigQuery API"},{"name":"clouddebugger.googleapis.com","title":"Cloud Debugger API"},{"name":"cloudasset.googleapis.com","title":"Cloud Asset API"},{"name":"cloudapis.googleapis.com","title":"Google Cloud APIs"},{"name":"compute.googleapis.com","title":"Compute Engine API"},{"name":"serviceusage.googleapis.com","title":"Service Usage API"},{"name":"cloudresourcemanager.googleapis.com","title":"Cloud Resource Manager API"},{"name":"apikeys.googleapis.com","title":"API Keys API"},{"name":"appengine.googleapis.com","title":"App Engine Admin API"},{"name":"bigtableadmin.googleapis.com","title":"Cloud Bigtable Admin API"},{"name":"admin.googleapis.com","title":"Admin SDK API"},{"name":"kmsinventory.googleapis.com","title":"KMS Inventory API"},{"name":"container.googleapis.com","title":"Kubernetes Engine API"},{"name":"sqladmin.googleapis.com","title":"Cloud SQL Admin API"},{"name":"iam.googleapis.com","title":"Identity and Access Management (IAM) API"},{"name":"oslogin.googleapis.com","title":"Cloud OS Login API"},{"name":"bigquerystorage.googleapis.com","title":"BigQuery Storage API"},{"name":"bigtabletableadmin.googleapis.com","title":"Cloud Bigtable Table Admin API"},{"name":"memcache.googleapis.com","title":"Cloud Memorystore for Memcached API"},{"name":"servicenetworking.googleapis.com","title":"Service Networking API"},{"name":"storage-api.googleapis.com","title":"Google Cloud Storage JSON API"},{"name":"cloudfunctions.googleapis.com","title":"Cloud Functions API"},{"name":"storage.googleapis.com","title":"Cloud Storage API"},{"name":"iamcredentials.googleapis.com","title":"IAM Service Account Credentials API"},{"name":"datastore.googleapis.com","title":"Cloud Datastore API"},{"name":"dns.googleapis.com","title":"Cloud DNS API"},{"name":"file.googleapis.com","title":"Cloud Filestore API"},{"name":"storage-component.googleapis.com","title":"Cloud Storage"},{"name":"containerregistry.googleapis.com","title":"Container Registry API"},{"name":"pubsub.googleapis.com","title":"Cloud Pub/Sub API"},{"name":"bigquerymigration.googleapis.com","title":"BigQuery Migration API"},{"name":"containerfilesystem.googleapis.com","title":"Container File System API"},{"name":"source.googleapis.com","title":"Legacy Cloud Source Repositories API"},{"name":"sql-component.googleapis.com","title":"Cloud SQL"},{"name":"deploymentmanager.googleapis.com","title":"Cloud Deployment Manager V2 API"},{"name":"monitoring.googleapis.com","title":"Cloud Monitoring API"},{"name":"servicemanagement.googleapis.com","title":"Service Management API"},{"name":"cloudkms.googleapis.com","title":"Cloud Key Management Service (KMS) API"},{"name":"accessapproval.googleapis.com","title":"Access Approval API"},{"name":"essentialcontacts.googleapis.com","title":"Essential Contacts API"},{"name":"redis.googleapis.com","title":"Google Cloud Memorystore for Redis API"}],"projectNumber":"554880214893","lifecycleState":"ACTIVE","createTime":1686115018,"labels":null,"accessApprovalSettings":null,"selfLink":"https://www.googleapis.com/compute/beta/projects/serious-conduit-389105","id":"7542766970734488923","type":"Project","name":"serious-conduit-389105","dome9Id":"8|ca5ef528-d8dd-41d8-a022-1a820a6adb60|ProjectInfo|serious-conduit-389105","accountNumber":"serious-conduit-389105","assetLabels":null,"region":"Global","externalFindings":null},"remediationActions":[],"action":"Detect","additionalFields":[]}