{"status":"Failed","policy":{"name":"Webhooks","description":""},"findingKey":"IUkE5efmdY5ymyDQMHoUeg","findingId":"IUkE5efmdY5ymyDQMHoUeg","cloudGuardAccountId":"51722","origin":"Compliance Engine","bundle":{"name":"GCP CloudGuard Best Practices","description":"CloudGuard Best Practices for securing GCP Account","id":-9},"reportTime":"2023-06-09T09:04:54.86Z","rule":{"name":"Avoid using pre-IAM basic (primitive) roles","ruleId":"D9.GCP.IAM.12","description":"Basic roles include many permissions across all GCP services. Using them will result violation of the principle of least privilege. You should avoid using basic roles, and use predefined roles or custom roles instead.","remediation":"\n**From Portal**\n1. Go to IAM & admin/IAM using https://console.cloud.google.com/iam-admin/iam\n2. Go to the Principals\n3. Identify the member with the owner/basic roles, add the roles that each member needs while following the principle of least privilege, then remove any owner/editor roles.\n\n\n**From Command Line**\n1. Get the projects policy and write it to a yaml file,Run:\n```\ngcloud projects get-iam-policy PROJECT_ID PATH_TO_NEWLY_CREATED_FILE\n```\n2. In the created yaml add the roles that each member needs while following the principle of least privilege, then remove owner/editor roles.\n3. Set the new iam policy:\n```\ngcloud projects set-iam-policy PROJECT_ID PATH_TO_EDITED_FILE\n```\n\n**References**\n1. https://cloud.google.com/sdk/gcloud/reference/projects/get-iam-policy\n2. https://cloud.google.com/sdk/gcloud/reference/projects/set-iam-policy\n3. https://cloud.google.com/iam/docs/understanding-roles\n4. https://cloud.google.com/iam/docs/permissions-reference","complianceTags":"Identity and Access Management","logicHash":"+kx5hYR8kFpf2rhf+kFnTQ","severity":"High"},"account":{"id":"serious-conduit-389105","name":"GCP Demo Account NU","vendor":"GCP","dome9CloudAccountId":"ca5ef528-d8dd-41d8-a022-1a820a6adb60","organizationalUnitId":"00000000-0000-0000-0000-000000000000","organizationalUnitPath":""},"region":"Global","entity":{"eTag":"BwX9lAgKdAg=","version":1,"bindings":[{"eTag":null,"role":"roles/cloudasset.viewer","members":["serviceAccount:cloudguard-connect@serious-conduit-389105.iam.gserviceaccount.com"]},{"eTag":null,"role":"roles/cloudfunctions.serviceAgent","members":["serviceAccount:service-554880214893@gcf-admin-robot.iam.gserviceaccount.com"]},{"eTag":null,"role":"roles/compute.serviceAgent","members":["serviceAccount:service-554880214893@compute-system.iam.gserviceaccount.com"]},{"eTag":null,"role":"roles/container.serviceAgent","members":["serviceAccount:service-554880214893@container-engine-robot.iam.gserviceaccount.com"]},{"eTag":null,"role":"roles/containerregistry.ServiceAgent","members":["serviceAccount:service-554880214893@containerregistry.iam.gserviceaccount.com"]},{"eTag":null,"role":"roles/editor","members":["serviceAccount:554880214893-compute@developer.gserviceaccount.com","serviceAccount:554880214893@cloudservices.gserviceaccount.com","serviceAccount:serious-conduit-389105@appspot.gserviceaccount.com"]},{"eTag":null,"role":"roles/file.serviceAgent","members":["serviceAccount:service-554880214893@cloud-filer.iam.gserviceaccount.com"]},{"eTag":null,"role":"roles/iam.securityReviewer","members":["serviceAccount:cloudguard-connect@serious-conduit-389105.iam.gserviceaccount.com"]},{"eTag":null,"role":"roles/memcache.serviceAgent","members":["serviceAccount:service-554880214893@cloud-memcache-sa.iam.gserviceaccount.com"]},{"eTag":null,"role":"roles/owner","members":["user:nils@nilsujma.io"]},{"eTag":null,"role":"roles/pubsub.serviceAgent","members":["serviceAccount:service-554880214893@gcp-sa-pubsub.iam.gserviceaccount.com"]},{"eTag":null,"role":"roles/redis.serviceAgent","members":["serviceAccount:service-554880214893@cloud-redis.iam.gserviceaccount.com"]},{"eTag":null,"role":"roles/viewer","members":["serviceAccount:cloudguard-connect@serious-conduit-389105.iam.gserviceaccount.com"]}],"auditConfigs":null,"selfLink":null,"id":"IAM-POLICY-serious-conduit-389105","type":"GcpIamPolicy","name":null,"dome9Id":"8|ca5ef528-d8dd-41d8-a022-1a820a6adb60|IamPolicy","accountNumber":"serious-conduit-389105","assetLabels":null,"region":"Global","externalFindings":null},"remediationActions":[],"action":"Detect","additionalFields":[]}